AbstractTable,Tables,0,1,,,,,,,,,,,,,,,,,
TableOfSolvencyStatusAbstract,AdmittedAssetsUnderSolvencyII-AdmittedLiabilitiesUnderSolvencyII-AvailableCapitalUnderSolvencyII-CoreTierOneCapitalUnderSolvencyII-CoreTierTwoCapital-SupplementaryTierOneCapital-SupplementaryTierTwoCapital-MinimumCapitalUnderSolvencyII-MinimumCapitalForQuantifiableRisk-MinimumCapitalForInsuranceRiskOfLifeInsuranceBusiness-MinimumCapitalForInsuranceRiskOfNonLifeInsuranceBusiness-MinimumCapitalForMarketRisk-MinimumCapitalForCreditRisk-QuantifiableRiskDiversificationEffect-LossAbsorptionOfSpecificInsuranceContract-MinimumCapitalForControlRisk-AdditionalCapital-CoreSolvencySurplus-CoreSolvencyAdequacyRatio-ComprehensiveSolvencySurplus-ComprehensiveSolvencyAdequacyRatio,begin,end,,,,,,,,,,,,,,,,,
S01-偿付能力状况表 [abstract],认可资产-认可负债-实际资本-核心一级资本-核心二级资本-附属一级资本-附属二级资本-最低资本-量化风险最低资本-寿险业务保险风险最低资本-非寿险业务保险风险最低资本-市场风险最低资本-信用风险最低资本-量化风险分散效应-特定类别保险合同损失吸收效应-控制风险最低资本-附加资本-核心偿付能力溢额-核心偿付能力充足率-综合偿付能力溢额-综合偿付能力充足率,期末数,期初数,,,,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.PERIOD_NAME WHEN '期末' THEN T.VALUE_DATA ELSE 0 END ) '期末数',
MAX(case T.PERIOD_NAME when '季初' then T.VALUE_DATA ELSE 0 END ) '期初数'
FROM 
(
SELECT
  C.PERIOD_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND (C.PERIOD_NAME = '期末' OR C.PERIOD_NAME = '季初')
  AND  DIM_GID = ' '
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,,,,,,,,,,,,,,,,,
TableOfAvailableCapitalAbstract,CoreTierOneCapitalUnderSolvencyII-NetAssetsLiabilities-AdjustmentFromNetAssetsToCoreTierOneCapital-AdjustmentsOfCoreTierOneCapitalDifferenceBetweenAdmittedValueOfLongTermEquityInvestmentOfInsuranceCompanyInTheirSubsidiariesBasedOnEquityMethodAndItsBookValueInFinancialStatements-AdjustmentsOfCoreTierOneCapitalDifferenceBetweenBookValueOfReinsuranceReserveReceivableForLifeInsuranceBusinessAndItsAdmittedValue-AdjustmentsOfCoreTierOneCapitalBookValueOfNonAdmittedAssets-AdjustmentsOfCoreTierOneCapitalFairValueIncreaseOfInvestmentPropertyMeasuredAtFairValue-AdjustmentsOfCoreTierOneCapitalAccumulatedFairValueIncreaseOfOwnedPropertyWhichWasEverMeasuredAtFairValue-AdjustmentsOfCoreTierOneCapitalCatastropheRiskPremiumReserveForAgriculturalInsuranceBusiness-AdjustmentsOfCoreTierOneCapitalDifferenceBetweenBookValueOfLifeInsuranceReservesInFinancialStatementsAndSumOfAdmittedValueOfInsuranceContractLiabilitiesAndIncomeTaxProvisionInSolvencyReport-AdjustmentsOfCoreTierOneCapitalAdmittedValueOfCashValueGuarantee-AdjustmentsOfCoreTierOneCapitalAmountOfCapitalInstrumentsClassifiedAsLiabilitiesWhichCanBeIncludedInCoreTierOneCapitalPursuantToRelevantStandards-AdjustmentsOfCoreTierOneCapitalOtherItemsForAdjustmentAsSpecifiedByCirc-CoreTierTwoCapital-CoreTierTwoCapitalPreferredShares-OtherCoreTierTwoCapital-DeductibleCoreTierTwoCapitalThatExceedsLimitAmount-SupplementaryTierOneCapital-SubordinatedTermDebts-CapitalSupplementBonds-SubordinatedConvertibleBonds-AdjustmentsOfCoreTierTwoCapitalFairValueIncreaseOfInvestmentPropertyMeasuredAtFairValue-AdjustmentsOfCoreTierTwoCapitalAccumulatedFairValueIncreaseOfOwnedPropertyWhichWasEverMeasuredAtFairValue-OtherSupplementaryTierOneCapital-DeductibleSupplementaryTierOneCapitalThatExceedsLimitAmount-SupplementaryTierTwoCapital-OtherSupplementaryTierTwoCapital-DeductibleSupplementaryTierTwoCapitalThatExceedsLimitAmount-AvailableCapitalUnderSolvencyII,begin,end,,,,,,,,,,,,,,,,,
S02-实际资本表 [abstract],核心一级资本-净资产-对净资产的调整额-子公司权益法调整-寿险业务应收分保责任准备金账面价值与认可价值的差额-各项非认可资产的账面价值-以公允价值计量的投资性房地产的公允价值增值-自用房地产中曾以公允价值计量的房地产的累计评估增值-对农业保险提取的大灾风险准备金-财务报表下寿险责任准备金负债的账面价值与偿付能力报告下对应的保险合同负债认可价值和所得税准备认可价值之和的差额-现金价值保证-符合核心一级资本标准的负债类资本工具按规定可计入核心一级资本的金额-保监会规定的其他调整项目-核心二级资本-优先股-其他核心二级资本-减：超限额应扣除的部分-附属一级资本-次级定期债务-资本补充债券-可转换次级债-以公允价值计量的投资性房地产的公允价值增值-自用房地产中曾以公允价值计量的房地产的累计评估增值-其他附属一级资本-减：超限额应扣除的部分-附属二级资本-应急资本等其他附属二级资本-减：超限额应扣除的部分-实际资本合计,期末数,期初数,,,,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.PERIOD_NAME WHEN '期末' THEN T.VALUE_DATA ELSE 0 END ) '期末数',
MAX(case T.PERIOD_NAME when '季初' then T.VALUE_DATA ELSE 0 END ) '期初数'
FROM 
(
SELECT
  C.PERIOD_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND (C.PERIOD_NAME = '期末' OR C.PERIOD_NAME = '季初')
  AND  DIM_GID = ' '
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
TableOfAdmittedAssetsAbstract,CashAndLiquidityManagementInstrumentsUnderSolvencyIIMember-CashOnHandUnderSolvencyIIMember-DemandDepositsUnderSolvencyIIMember-LiquidityManagementInstrumentsUnderSolvencyIIMember-InvestmentAssetsUnderSolvencyIIMember-TermDepositsUnderSolvencyIIMember-NegotiatedDepositsUnderSolvencyIIMember-GovernmentBondsUnderSolvencyIIMember-FinancialBondsUnderSolvencyIIMember-EnterpriseBondsUnderSolvencyIIMember-AssetSecuritizationProductsUnderSolvencyIIMember-TrustAssetsUnderSolvencyIIMember-InsuranceAssetManagementProductsUnderSolvencyIIMember-InvestmentInInfrastructuresUnderSolvencyIIMember-EquityInvestmentUnderSolvencyIIMember-InvestmentPropertyUnderSolvencyIIMember-DerivativeFinancialAssetsUnderSolvencyIIMember-OtherInvestmentAssetsUnderSolvencyIIMember-EquityInSubsidiariesJointVenturesAndAssociatedCompanyUnderSolvencyIIMember-ReinsuranceAssetsUnderSolvencyIIMember-ReinsuranceReserveReceivableUnderSolvencyIIMember-ReinsuranceReceivableUnderSolvencyIIMember-DepositsRetainedByCedentsUnderSolvencyIIMember-OtherReinsuranceAssetsUnderSolvencyIIMember-ReceivablesAndPrepaymentsUnderSolvencyIIMember-PremiumReceivableUnderSolvencyIIMember-InterestReceivableUnderSolvencyIIMember-DividendsReceivableUnderSolvencyIIMember-PrepaidIndemnitiesUnderSolvencyIIMember-RefundableDepositsUnderSolvencyIIMember-PolicyLoansUnderSolvencyIIMember-OtherReceivablesAndTemporaryPaymentsUnderSolvencyIIMember-FixedAssetsUnderSolvencyIIMember-FixedAssetsPropertyForOwnUseUnderSolvencyIIMember-FixedAssetsMachineryAndEquipmentUnderSolvencyIIMember-FixedAssetsTransportEquipmentUnderSolvencyIIMember-FixedAssetsConstructionInProgressUnderSolvencyIIMember-FixedAssetsOfficeFurnitureUnderSolvencyIIMember-OtherFixedAssetsUnderSolvencyIIMember-IntangibleAssetsLandUseRightsUnderSolvencyIIMember-SeparateAccountAssetsUnderSolvencyIIMember-OtherAdmittedAssetsUnderSolvencyIIMember-DeferredIncomeTaxAssetsExceptDeferredIncomeTaxAssetsCausedByOperatingLossesUnderSolvencyIIMember-ContingentCapitalUnderSolvencyIIMember-OtherAdmittedAssetsOthersUnderSolvencyIIMember,AssetsUnderSolvencyIIBookValue_begin,AssetsUnderSolvencyIINonAdmittedValue_begin,AdmittedAssetsUnderSolvencyII_begin,AssetsUnderSolvencyIIBookValue_end,AssetsUnderSolvencyIINonAdmittedValue_end,AdmittedAssetsUnderSolvencyII_end,,,,,,,,,,,,,
S03-认可资产表 [abstract],现金及流动性管理工具 [member]-库存现金 [member]-活期存款 [member]-流动性管理工具 [member]-投资资产 [member]-定期存款 [member]-协议存款 [member]-政府债券 [member]-金融债 [member]-企业债券 [member]-资产证券化产品 [member]-信托资产 [member]-保险资产管理产品 [member]-基础设施投资 [member]-权益投资 [member]-投资性房地产 [member]-衍生金融资产 [member]-其他投资资产 [member]-在子公司、合营企业和联营企业中的权益 [member]-再保险资产 [member]-应收分保准备金 [member]-应收分保账款 [member]-存出分保保证金 [member]-其他再保险资产 [member]-应收及预付款项 [member]-应收保费 [member]-应收利息 [member]-应收股利 [member]-预付赔款 [member]-存出保证金 [member]-保单质押贷款 [member]-其他应收和暂付款 [member]-固定资产 [member]-自用房屋 [member]-机器设备 [member]-交通运输设备 [member]-在建工程 [member]-办公家具 [member]-其他固定资产 [member]-土地使用权 [member]-独立账户资产 [member]-其他认可资产 [member]-递延所得税资产 [member]-应急资本 [member]-其他 [member],账面价值_期初,非认可价值_期初,认可价值_期初,账面价值_期末,非认可价值_期末,认可价值_期末,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN '期末AssetsUnderSolvencyIIBookValue' THEN T.VALUE_DATA ELSE 0 END ) '账面价值',
MAX(CASE T.ELE_NAME WHEN '期末AssetsUnderSolvencyIINonAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '非认可价值',
MAX(CASE T.ELE_NAME WHEN '期末AdmittedAssetsUnderSolvencyII' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN '季初AssetsUnderSolvencyIIBookValue' THEN T.VALUE_DATA ELSE 0 END ) '账面价值(期初)',
MAX(CASE T.ELE_NAME WHEN '季初AssetsUnderSolvencyIINonAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '非认可价值(期初)',
MAX(CASE T.ELE_NAME WHEN '季初AdmittedAssetsUnderSolvencyII' THEN T.VALUE_DATA ELSE 0 END ) '认可价值(期初)'

FROM
(
SELECT
  CONCAT(C.PERIOD_NAME,ELE_NAME) ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'AssetsUnderSolvencyIIBookValue','AssetsUnderSolvencyIINonAdmittedValue','AdmittedAssetsUnderSolvencyII') --   元素名称
  AND C.PERIOD_NAME in( '期末' ,'季初')
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE AXIS_VALUE= (SELECT OID FROM psx_element WHERE ELE_NAME = 'AdmittedAssetsDisclosureByItemsAxis') 
                  AND MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,,,,,,,,,,,,,,,,,
TableOfAdmittedLiabilitiesAbstract,ReserveLiabilitiesUnderSolvencyII-OutstandingBenefitsReserveUnderSolvencyII-OutstandingBenefitsReserveOfLifeInsuranceContractUnderSolvencyII-OutstandingBenefitsReserveOfNonLifeInsuranceContractUnderSolvencyII-OutstandingLossReserveUnderSolvencyII-OutstandingLossReserveWhichIsOccurredButNotReportedUnderSolvencyII-FinancialLiabilitiesUnderSolvencyII-SecuritiesSoldUnderRepurchaseAgreementsUnderSolvencyII-PolicyholderDepositsAndInvestmentsUnderSolvencyII-DerivativeFinancialLiabilitiesUnderSolvencyII-OtherFinancialLiabilitiesUnderSolvencyII-PayablesAndAdvanceReceiptsUnderSolvencyII-PolicyholderBonusesPayableUnderSolvencyII-BenefitsPayableUnderSolvencyII-AdvancesInsurancePremiumUnderSolvencyII-ReinsurancePayableUnderSolvencyII-FeeAndCommissionsIncomePayableUnderSolvencyII-EmployeeBenefitsPayablesUnderSolvencyII-TaxPayablesUnderSolvencyII-DepositsFromCedentsUnderSolvencyII-OtherPayablesAndAdvanceReceiptsUnderSolvencyII-ProvisionsUnderSolvencyII-SeparateAccountLiabilitiesUnderSolvencyII-CapitalLiabilitiesUnderSolvencyII-OtherAdmittedLiabilitiesUnderSolvencyII-DeferredIncomeTaxLiabilitiesUnderSolvencyII-CashValueGuaranteeUnderSolvencyII-IncomeTaxProvisionUnderSolvencyII-AdmittedLiabilitiesUnderSolvencyII,begin,end,,,,,,,,,,,,,,,,,
S04-认可负债表 [abstract],准备金负债-未到期责任准备金-寿险合同未到期责任准备金-非寿险合同未到期责任准备金-未决赔款责任准备金-其中：已发生未报案未决赔款准备金-金融负债-卖出回购证券-保户储金及投资款-衍生金融负债-其他金融负债-应付及预收款项-应付保单红利-应付赔付款-预收保费-应付分保账款-应付手续费及佣金-应付职工薪酬-应交税费-存入分保保证金-其他应付及预收款项-预计负债-独立账户负债-资本性负债-其他认可负债-递延所得税负债-现金价值保证-所得税准备-认可负债合计,期末数,期初数,,,,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.PERIOD_NAME WHEN '期末' THEN T.VALUE_DATA ELSE 0 END ) '期末数',
MAX(case T.PERIOD_NAME when '季初' then T.VALUE_DATA ELSE 0 END ) '期初数'
FROM 
(
SELECT
  C.PERIOD_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND (C.PERIOD_NAME = '期末' OR C.PERIOD_NAME = '季初')
  AND  DIM_GID = ' '
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,,,,,,,,,,,,,,,,,
TableOfMinimumCapitalAbstract,MinimumCapitalForQuantifiableRisk-MinimumCapitalForInsuranceRiskOfLifeInsuranceBusiness-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForSurrenderRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForExpenseRisk-InsuranceRiskOfLifeInsuranceBusinessRiskDiversificationEffect-MinimumCapitalForInsuranceRiskOfNonLifeInsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRisk-InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffect-MinimumCapitalForMarketRisk-MarketRiskMinimumCapitalForInterestRateRisk-MarketRiskMinimumCapitalForEquityPriceRisk-MarketRiskMinimumCapitalForPropertyPriceRisk-MarketRiskMinimumCapitalForOverseasFixedIncomeInvestmentAssetsPriceRisk-MarketRiskMinimumCapitalForOverseasEquityInvestmentAssetsPriceRisk-MarketRiskMinimumCapitalForExchangeRateRisk-MarketRiskRiskDiversificationEffect-MinimumCapitalForCreditRisk-CreditRiskMinimumCapitalForSpreadRisk-CreditRiskMinimumCapitalForCounterpartyDefaultRisk-CreditRiskRiskDiversificationEffect-QuantifiableRiskDiversificationEffect-LossAbsorptionOfSpecificInsuranceContract-SpecificInsuranceContractAdjustedOfLossAbsorptionUpperLimitNotToBeTakenIntoConsideration-UpperLimitForCapacityOfLossAbsorptionAdjustmentOfSpecificInsuranceContract-MinimumCapitalForControlRisk-AdditionalCapital-CountercyclicalAdditionalCapital-AdditionalCapitalOfDomesticSystemicallyImportantInsurers-AdditionalCapitalOfGlobalSystemicallyImportantInsurers-OtherAdditionalCapital-MinimumCapitalUnderSolvencyII,begin,end,,,,,,,,,,,,,,,,,
S05-最低资本表 [abstract],量化风险最低资本-寿险业务保险风险最低资本合计-寿险业务保险风险-损失发生风险最低资本-寿险业务保险风险-退保风险最低资本-寿险业务保险风险-费用风险最低资本-寿险业务保险风险-风险分散效应-非寿险业务保险风险最低资本合计-非寿险业务保险风险-保费及准备金风险最低资本-非寿险业务保险风险-巨灾风险最低资本-非寿险业务保险风险-风险分散效应-市场风险-最低资本合计-市场风险-利率风险最低资本-市场风险-权益价格风险最低资本-市场风险-房地产价格风险最低资本-市场风险-境外固定收益类资产价格风险最低资本-市场风险-境外权益类资产价格风险最低资本-市场风险-汇率风险最低资本-市场风险-风险分散效应-信用风险-最低资本合计-信用风险-利差风险最低资本-信用风险-交易对手违约风险最低资本-信用风险-风险分散效应-量化风险分散效应-特定类别保险合同损失吸收效应-损失吸收调整-不考虑上限-损失吸收效应调整上限-控制风险最低资本-附加资本-逆周期附加资本-D-SII附加资本-G-SII附加资本-其他附加资本-最低资本,期末数,期初数,,,,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.PERIOD_NAME WHEN '期末' THEN T.VALUE_DATA ELSE 0 END ) '期末数',
MAX(case T.PERIOD_NAME when '季初' then T.VALUE_DATA ELSE 0 END ) '期初数'
FROM 
(
SELECT
  C.PERIOD_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND (C.PERIOD_NAME = '期末' OR C.PERIOD_NAME = '季初')
  AND  DIM_GID = ' '
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,,,,,,,,,,,
SpreadRiskOfAssetsDetailsAbstract,PolicyFinanceBondsMember-BondsWhichExcludingPolicyFinanceBondsMember-AssetSecuritizationProductsUnderSolvencyIIMember-FixedIncomeTrustPlansMember-OtherFixedIncomeProductsMember,SpreadRiskSecurityName,SpreadRiskSecurityCode,SpreadRiskCreditRatingsForAssets,SpreadRiskModifiedDuration,SpreadRiskAdmittedValue,SpreadRiskRiskExposure,SpreadRiskBaseRiskFactor,CreditRiskMinimumCapitalForSpreadRisk,,,,,,,,,,,
CR01-利差风险所涉资产明细表 [abstract],政策性金融债 [member]-除政策性金融债外的债券 [member]-资产证券化产品 [member]-固定收益类信托计划 [member]-其他固定收益类产品 [member],证券名称,证券代码,信用评级,修正久期（年）,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'SpreadRiskSecurityName' then T.VALUE_DATA else 0 end ) '证券名称',
Max(case T.ELE_NAME when 'SpreadRiskSecurityCode' then T.VALUE_DATA else 0 end ) '证券代码',
Max(case T.ELE_NAME when 'SpreadRiskCreditRatingsForAssets' then T.VALUE_DATA else 0 end ) '信用评级',
Max(case T.ELE_NAME when 'SpreadRiskModifiedDuration' then T.VALUE_DATA else 0 end ) '修正久期（年）',
Max(case T.ELE_NAME when 'SpreadRiskAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'SpreadRiskRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'SpreadRiskBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'CreditRiskMinimumCapitalForSpreadRisk' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ( 'SpreadRiskSecurityName',
   'SpreadRiskSecurityCode',
   'SpreadRiskCreditRatingsForAssets',
   'SpreadRiskModifiedDuration',
   'SpreadRiskAdmittedValue',
   'SpreadRiskRiskExposure',
   'SpreadRiskBaseRiskFactor',
   'CreditRiskMinimumCapitalForSpreadRisk'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(OID , '%%') from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:assets,0,1,,,,,,,,,,,,,,,,,,
relation:buy-company-assets,2,4,5,7,3,6,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsAbstract,DepositsNotInThirdPartyPaymentInstitutionsMember-CashOnHandUnderSolvencyIIMember-DemandDepositsUnderSolvencyIIMember-MoneyMarketFundMember-ShortTimeFinancingBondsMember-SecuritiesPurchasedUnderResaleAgreementsMember-CentralBankBillsMember-CommercialBankNotesMember-NegotiableCertificatesOfDepositsMember-ShortTermLendingMember-ClearingReserveFundInChinaSecuritiesDepositoryAndClearingCorporationAndChinaCentralDepositoryAndClearingCoLtdMember-FundsDueFromThirdPartyPaymentAgenciesMember,CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsAdmittedValue,CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsInterestReceivable,CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsRiskExposure,CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsBaseRiskFactor,CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsMinimumCapital,,,,,,,,,,,,,,
CR02-交易对手违约风险，现金及流动性管理工具 [abstract],未存放在第三方支付机构账户的资金 [member]-库存现金 [member]-活期存款 [member]-货币市场基金 [member]-短期融资券 [member]-买入返售证券 [member]-央行票据 [member]-商业银行票据 [member]-大额可转让存单 [member]-拆出资金 [member]-存放在中国证券登记结算公司和中央国债登记结算公司的清备付金 [member]-存放在第三方支付机构账户的资金 [member]-,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsAdmittedValue',
   'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsInterestReceivable',
   'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsRiskExposure',
   'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsBaseRiskFactor',
   'CounterpartyDefaultRiskCashAndLiquidityManagementInstrumentsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE AXIS_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = 'CounterpartyDefaultRiskTypesOfCashAndLiquidityManagementInstrumentsAxis') 
                  AND MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
CounterpartyDefaultRiskBankDepositsAbstract,TermDepositsAndNegotiatedDepositsMember-CommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-StateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-JointStockCommercialBankPostSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-CityCommercialBankAndForeignCommercialBankWithInternationalCreditRatingOfAAndAboveWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-OtherDomesticCommercialBankAndOverseasBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-CommercialBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsTermDepositsAndNegotiatedDepositsMember-OtherDepositTakingInstitutionsTermDepositsAndNegotiatedDepositsMember-StructuredDepositsMember-StructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-CommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-StateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-JointStockCommercialBankPostSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-CityCommercialBankAndForeignCommercialBankWithInternationalCreditRatingOfAAndAboveWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-OtherDomesticCommercialBankAndOverseasBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-CommercialBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsStructuredDepositsWithGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember-StructuredDepositsWithoutGuaranteedPrincipalsByBanksInCaseOfEarlyWithdrawalMember,CounterpartyDefaultRiskBankDepositsNameOfDepositTakingInstitutions,CounterpartyDefaultRiskBankDepositsAdmittedValue,CounterpartyDefaultRiskBankDepositsInterestReceivable,CounterpartyDefaultRiskBankDepositsRiskExposure,CounterpartyDefaultRiskBankDepositsBaseRiskFactor,CounterpartyDefaultRiskBankDepositsMinimumCapital,,,,,,,,,,,,,
CR03-交易对手违约风险，银行存款 [abstract],定期存款、协议存款 [member]-各级资本充足率全部达到监管要求 [member]-国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行、国际信用评级在A级以上的外资商业银行 [member]-其他境内商业银行和境外银行 [member]-各级资本充足率未全部达到监管要求 [member]-其他存款机构 [member]-结构性存款 [member]-提前支取银行保证本金 [member]-各级资本充足率全部达到监管要求 [member]-国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行、国际信用评级在A级以上的外资商业银行 [member]-其他境内商业银行和境外银行 [member]-各级资本充足率未全部达到监管要求 [member]-提前支取银行不保证本金 [member],存款机构名称,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsNameOfDepositTakingInstitutions' THEN T.VALUE_DATA ELSE 0 END ) '存款机构名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskBankDepositsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'CounterpartyDefaultRiskBankDepositsNameOfDepositTakingInstitutions','CounterpartyDefaultRiskBankDepositsAdmittedValue',
         'CounterpartyDefaultRiskBankDepositsInterestReceivable','CounterpartyDefaultRiskBankDepositsRiskExposure',
         'CounterpartyDefaultRiskBankDepositsBaseRiskFactor','CounterpartyDefaultRiskBankDepositsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
CounterpartyDefaultRiskFinancialBondsAbstract,FinancialBondsExcludingCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsMember-IssuerWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsFinancialBondExcludingCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsMember-PolicyBankStateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsFinancialBondExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-JointStockCommercialBankPostalSavingsBankInsuranceCompanyWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsFinancialBondsExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-CityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsFinancialBondsExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-OtherCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsFinancialBondsExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-FinancialBondsWithCreditRatingOfAaAndAboveIssuedByOtherNonBankingFinancialInstitutionsFinancialBondExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-FinancialBondsIssuedByNonStateOwnedCommercialBankWithCapitalAdequacyRatiosNotEntirelyMeetingRegulatoryRequirementsOrFinancialBondsIssuedByInsuranceCompanyWithSolvencyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsOrFinancialBondsIssuedByOtherNonBankingFinancialInstitutionsWithCreditRatingOfAaBelowExcludingCapitalInstrumentsSuchAsSubordinatedDebtAndHybridBondsMember-CapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankAndOtherInsuranceCompanyMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByPolicyBankStateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByJointStockCommercialBankPostalSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByCityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByOtherCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-AdditionalTierOneCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByPolicyBankStateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByJointStockCommercialBankPostalSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByCityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByOtherCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-TierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember-CoreTierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyMember-CoreTierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-CoreTierTwoCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember-SupplementaryCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyMember-SupplementaryCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-SupplementaryCapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsIssuedByInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember-CapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsWithoutDisposalOrConvertibleTermsIssuedByBankAndOtherInsuranceCompanyMember-CapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsWithoutDisposalOrConvertibleTermsIssuedByBankAndOtherInsuranceCompanyWithCapitalSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-CapitalInstrumentsSuchAsSubordinatedBondsAndHybridBondsWithoutDisposalOrConvertibleTermsIssuedByBankAndOtherInsuranceCompanyWithCapitalSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember,CounterpartyDefaultRiskFinancialBondsAdmittedValue,CounterpartyDefaultRiskFinancialBondsInterestReceivable,CounterpartyDefaultRiskFinancialBondsRiskExposure,CounterpartyDefaultRiskFinancialBondsBaseRiskFactor,CounterpartyDefaultRiskFinancialBondsMinimumCapital,,,,,,,,,,,,,,
CR04-交易对手违约风险，金融债 [abstract],金融债（不包含次级债、混合资本债等资本工具） [member]-发行方为各级资本充足率或偿付能力充足率全部达到监管要求的 [member]-政策性银行、国有商业银行 [member]-股份制商业银行、邮政储蓄银行、保险公司 [member]-城市商业银行 [member]-其他商业银行 [member]-其他非银行金融机构发行的信用评级在AA级以上（含AA级）的 [member]-发行方为各级资本充足率未全部达到监管要求的非国有商业银行、各级偿付能力充足率未全部达到监管要求的保险公司，或者其他非银行金融机构发行的信用评级在AA级以下的 [member]-银行和其他保险公司发行的次级债、混合资本债等资本工具 [member]-银行发行的其他一级资本工具 [member]-发行方为各级资本充足率全部达到监管要求的 [member]-政策性银行、国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行 [member]-其他商业银行 [member]-各级资本充足率未全部达到监管要求 [member]-银行发行的二级资本工具 [member]-发行方为各级资本充足率全部达到监管要求的 [member]-政策性银行、国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行 [member]-其他商业银行 [member]-各级资本充足率未全部达到监管要求 [member]-保险公司发行的核心二级资本工具 [member]-各级偿付能力充足率全部达到监管要求的 [member]-各级偿付能力充足率未全部达到监管要求的 [member]-保险公司发行的附属资本工具 [member]-各级偿付能力充足率全部达到监管要求的 [member]-各级偿付能力充足率未全部达到监管要求的 [member]-不附减记或转股条款的次级债券、混合资本债等资本工具 [member]-各级资本充足率（偿付能力）全部达到监管要求的银行（保险公司） [member]-各级资本充足率（偿付能力）未全部达到监管要求的银行（保险公司） [member],认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskFinancialBondsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskFinancialBondsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskFinancialBondsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskFinancialBondsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskFinancialBondsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('CounterpartyDefaultRiskFinancialBondsAdmittedValue',
    'CounterpartyDefaultRiskFinancialBondsInterestReceivable',
    'CounterpartyDefaultRiskFinancialBondsRiskExposure',
    'CounterpartyDefaultRiskFinancialBondsBaseRiskFactor',
    'CounterpartyDefaultRiskFinancialBondsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,,,,,,,,,,
CounterpartyDefaultRiskEnterpriseBondsCorporateBondsAbstract,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsAbstract,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBondName,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsResidualYears,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsCreditRatingsForAssets,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsAdmittedValue,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsInterestReceivable,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskExposure,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBaseRiskFactor,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskFactorOne,CounterpartyDefaultRiskEnterpriseBondsCorporateBondsMinimumCapital,,,,,,,,,,
CR05-交易对手违约风险，企业债、公司债 [abstract],CR05-交易对手违约风险，企业债、公司债 [abstract],债券名称,剩余年限（年）,资产的信用评级,认可价值,应收利息,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBondName' THEN T.VALUE_DATA ELSE 0 END ) '债券名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsResidualYears' THEN T.VALUE_DATA ELSE 0 END ) '剩余年限（年）',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBondName',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsResidualYears',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsCreditRatingsForAssets',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsAdmittedValue',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsInterestReceivable',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskExposure',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsBaseRiskFactor',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsRiskFactorOne',
    'CounterpartyDefaultRiskEnterpriseBondsCorporateBondsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:bond,0,,,,,,,,,,,,,,,,,,,
relation:buy-company-bond,1,2,3,4,5,6,7,8,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,,,,,,,,,,,
CounterpartyDefaultRiskAssetSecuritizationProductsAbstract,CounterpartyDefaultRiskAssetSecuritizationProductsAbstract,CounterpartyDefaultRiskAssetSecuritizationProductsProductName,CounterpartyDefaultRiskAssetSecuritizationProductsResidualYears,CounterpartyDefaultRiskAssetSecuritizationProductsCreditRatingsForAssets,CounterpartyDefaultRiskAssetSecuritizationProductsAdmittedValue,CounterpartyDefaultRiskAssetSecuritizationProductsInterestReceivable,CounterpartyDefaultRiskAssetSecuritizationProductsRiskExposure,CounterpartyDefaultRiskAssetSecuritizationProductsBaseRiskFactor,CounterpartyDefaultRiskAssetSecuritizationProductsMinimumCapital,,,,,,,,,,,
CR06-交易对手违约风险，资产证券化产品 [abstract],CR06-交易对手违约风险，资产证券化产品 [abstract],产品名称,剩余年限（年）,资产的信用评级,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsResidualYears' THEN T.VALUE_DATA ELSE 0 END ) '剩余年限（年）',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetSecuritizationProductsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskAssetSecuritizationProductsProductName',
   'CounterpartyDefaultRiskAssetSecuritizationProductsResidualYears',
   'CounterpartyDefaultRiskAssetSecuritizationProductsCreditRatingsForAssets',
   'CounterpartyDefaultRiskAssetSecuritizationProductsAdmittedValue',
   'CounterpartyDefaultRiskAssetSecuritizationProductsInterestReceivable',
   'CounterpartyDefaultRiskAssetSecuritizationProductsRiskExposure',
   'CounterpartyDefaultRiskAssetSecuritizationProductsBaseRiskFactor',
   'CounterpartyDefaultRiskAssetSecuritizationProductsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,,,,,,,,,,,,,,,,,,,
relation:buy-company-product,1,2,3,4,5,6,7,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankAbstract,CapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember-StateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember-JointStockCommercialBankPostSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember-CityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember-OtherCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember-CapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWealthManagementProductsOfCommercialBankMember,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankTypesOfAssets,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankAdmittedValue,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankInterestReceivable,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankRiskExposure,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankBaseRiskFactor,CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankMinimumCapital,,,,,,,,,,,,,
CR07-交易对手违约风险，商业银行理财产品 [abstract],各级资本充足率全部达到监管要求 [member]-国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行 [member]-其他商业银行 [member]-各级资本充足率未全部达到监管要求 [member],资产类别,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankTypesOfAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产类别',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankTypesOfAssets',
   'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankAdmittedValue',
   'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankInterestReceivable',
   'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankRiskExposure',
   'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankBaseRiskFactor',
   'CounterpartyDefaultRiskWealthManagementProductsOfCommercialBankMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND AXIS_COUNT = 1)
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,,,,,,,,
CounterpartyDefaultRiskTrustPlansAbstract,AbleToBeLookedThroughMember-UnableToBeLookedThroughMember,CounterpartyDefaultRiskTrustPlansProductName,CounterpartyDefaultRiskTrustPlansCreditRatingsForAssets,CounterpartyDefaultRiskTrustPlansIssuer,CounterpartyDefaultRiskTrustPlansCreditRatingOfIssuer,CounterpartyDefaultRiskTrustPlansAdmittedValue,CounterpartyDefaultRiskTrustPlansInterestReceivable,CounterpartyDefaultRiskTrustPlansRiskExposure,CounterpartyDefaultRiskTrustPlansBaseRiskFactor,CounterpartyDefaultRiskTrustPlansRiskFactorOne,CounterpartyDefaultRiskTrustPlansRiskFactorTwo,CounterpartyDefaultRiskTrustPlansMinimumCapital,,,,,,,,
CR08-交易对手违约风险，信托计划 [abstract],可穿透 [member]-无法穿透 [member],产品名称,资产的信用评级,发行主体,发行主体的信用评级,认可价值,应收利息,风险暴露,基础因子RF0,特征系数K1,特征系数K2,最低资本,,,,,,,,
sql,"
SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行主体',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansCreditRatingOfIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行主体的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskFactorTwo' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskTrustPlansProductName',
   'CounterpartyDefaultRiskTrustPlansCreditRatingsForAssets',
   'CounterpartyDefaultRiskTrustPlansIssuer',
   'CounterpartyDefaultRiskTrustPlansCreditRatingOfIssuer',
   'CounterpartyDefaultRiskTrustPlansAdmittedValue',
   'CounterpartyDefaultRiskTrustPlansInterestReceivable',
   'CounterpartyDefaultRiskTrustPlansRiskExposure',
   'CounterpartyDefaultRiskTrustPlansBaseRiskFactor',
   'CounterpartyDefaultRiskTrustPlansRiskFactorOne',
   'CounterpartyDefaultRiskTrustPlansRiskFactorTwo',
   'CounterpartyDefaultRiskTrustPlansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID) FROM psx_element WHERE ELE_NAME = '%s')
                    )
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,2,,,,,,,,,,,,,,,,,,
relation:buy-company-product,1,3,4,5,6,7,8,9,10,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,,,,,,
CounterpartyDefaultRiskTrustPlansThatCanBeLookedThroughDetailsAbstract,AbleToBeLookedThroughMember,CounterpartyDefaultRiskTrustPlansProductName,CounterpartyDefaultRiskTrustPlansUnderlyingAssetsName,CounterpartyDefaultRiskTrustPlansUnderlyingAssetsCode,CounterpartyDefaultRiskTrustPlansResidualYearsOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansCreditRatingsForUnderlyingAssets,CounterpartyDefaultRiskTrustPlansAdmittedValue,CounterpartyDefaultRiskTrustPlansInterestReceivable,CounterpartyDefaultRiskTrustPlansBaseRiskFactorOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansRiskFactorOneOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansRiskFactorTwoOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansRiskFactorThreeOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansMinimumCapitalOfUnderlyingAssets,CounterpartyDefaultRiskTrustPlansBaseRiskFactor,,,,,,
CR09-交易对手违约风险，可穿透信托计划明细数据 [abstract],可穿透 [member],产品名称,基础资产名称,资产代码,剩余年限（年）,资产的信用评级,认可价值,应收利息,基础资产对应的基础因子RF0,基础资产对应的特征系数K1,基础资产对应的特征系数K2,基础资产对应的特征系数K3,基础资产的最低资本,信托计划的基础因子RF0,,,,,,
sql,"#CR09-交易对手违约风险，可穿透信托计划明细数据 [abstract]

SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansUnderlyingAssetsName' THEN T.VALUE_DATA ELSE 0 END ) '基础资产名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansUnderlyingAssetsCode' THEN T.VALUE_DATA ELSE 0 END ) '资产代码',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansResidualYearsOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '剩余年限（年）',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansCreditRatingsForUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansBaseRiskFactorOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '基础资产对应的基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskFactorOneOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '基础资产对应的特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskFactorTwoOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '基础资产对应的特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansRiskFactorThreeOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '基础资产对应的特征系数K3',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansMinimumCapitalOfUnderlyingAssets' THEN T.VALUE_DATA ELSE 0 END ) '基础资产的最低资本',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskTrustPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '信托计划的基础因子RF0'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskTrustPlansProductName',
   'CounterpartyDefaultRiskTrustPlansUnderlyingAssetsName',
   'CounterpartyDefaultRiskTrustPlansUnderlyingAssetsCode',
   'CounterpartyDefaultRiskTrustPlansResidualYearsOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansCreditRatingsForUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansAdmittedValue',
   'CounterpartyDefaultRiskTrustPlansInterestReceivable',
   'CounterpartyDefaultRiskTrustPlansBaseRiskFactorOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansRiskFactorOneOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansRiskFactorTwoOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansRiskFactorThreeOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansMinimumCapitalOfUnderlyingAssets',
   'CounterpartyDefaultRiskTrustPlansBaseRiskFactor') --   元素名称
  AND C.PERIOD_NAME = '期末' 
 AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID) FROM psx_element WHERE ELE_NAME = '%s'))
) T
GROUP BY T.DIM_GID
",,,,,,,,,,,,,,,,,,,
node:product,0,1,2,,,,,,,,,,,,,,,,,
relation:hold-company-product,3,4,5,6,7,8,9,10,11,12,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,,,,,,,,,,,
CounterpartyDefaultRiskAssetManagementProductsAbstract,CounterpartyDefaultRiskAssetManagementProductsAbstract,CounterpartyDefaultRiskAssetManagementProductsProductName,CounterpartyDefaultRiskAssetManagementProductsCreditRatingsForAssets,CounterpartyDefaultRiskAssetManagementProductsIssuer,CounterpartyDefaultRiskAssetManagementProductsAdmittedValue,CounterpartyDefaultRiskAssetManagementProductsInterestReceivable,CounterpartyDefaultRiskAssetManagementProductsRiskExposure,CounterpartyDefaultRiskAssetManagementProductsBaseRiskFactor,CounterpartyDefaultRiskAssetManagementProductsMinimumCapital,,,,,,,,,,,
CR10-交易对手违约风险，资产管理产品 [abstract],CR10-交易对手违约风险，资产管理产品 [abstract],产品名称,资产的信用评级,发行机构,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskAssetManagementProductsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskAssetManagementProductsProductName',
   'CounterpartyDefaultRiskAssetManagementProductsCreditRatingsForAssets',
   'CounterpartyDefaultRiskAssetManagementProductsIssuer',
   'CounterpartyDefaultRiskAssetManagementProductsAdmittedValue',
   'CounterpartyDefaultRiskAssetManagementProductsInterestReceivable',
   'CounterpartyDefaultRiskAssetManagementProductsRiskExposure',
   'CounterpartyDefaultRiskAssetManagementProductsBaseRiskFactor',
   'CounterpartyDefaultRiskAssetManagementProductsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,2,,,,,,,,,,,,,,,,,,
relation:hold-company-product,1,3,4,5,6,7,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,,,,,,,,,,
CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansAbstract,InfrastructureDebtInvestmentPlansMember-InfrastructureEquityInvestmentPlansWithGuaranteeClausesMember,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansProductName,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansCreditRatingsForAssets,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansIssuer,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansFinancingBody,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansAdmittedValue,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansInterestReceivable,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansRiskExposure,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansBaseRiskFactor,CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansMinimumCapital,,,,,,,,,,
CR11-交易对手违约风险，基础设施债权投资计划 [abstract],基础设施债权投资计划 [member]-带有保证条款的基础设施股权投资计划 [member],产品名称,资产的信用评级,发行机构,融资主体,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行主体',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansFinancingBody' THEN T.VALUE_DATA ELSE 0 END ) '融资主体',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansProductName',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansCreditRatingsForAssets',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansIssuer',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansFinancingBody',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansAdmittedValue',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansInterestReceivable',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansRiskExposure',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansBaseRiskFactor',
   'CounterpartyDefaultRiskInfrastructureDebtInvestmentPlansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                    )
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,2,3,,,,,,,,,,,,,,,,,
relation:hold-company-product,1,4,5,6,7,8,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,,,,,,,,,,
CounterpartyDefaultRiskPropertyDebtInvestmentPlansAbstract,CounterpartyDefaultRiskPropertyDebtInvestmentPlansAbstract,CounterpartyDefaultRiskPropertyDebtInvestmentPlansProductName,CounterpartyDefaultRiskPropertyDebtInvestmentPlansCreditRatingsForAssets,CounterpartyDefaultRiskPropertyDebtInvestmentPlansIssuer,CounterpartyDefaultRiskPropertyDebtInvestmentPlansFinancingBody,CounterpartyDefaultRiskPropertyDebtInvestmentPlansAdmittedValue,CounterpartyDefaultRiskPropertyDebtInvestmentPlansInterestReceivable,CounterpartyDefaultRiskPropertyDebtInvestmentPlansRiskExposure,CounterpartyDefaultRiskPropertyDebtInvestmentPlansBaseRiskFactor,CounterpartyDefaultRiskPropertyDebtInvestmentPlansMinimumCapital,,,,,,,,,,
CR12-交易对手违约风险，不动产债权投资计划 [abstract],CR12-交易对手违约风险，不动产债权投资计划 [abstract],产品名称,资产的信用评级,发行机构,融资主体,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansFinancingBody' THEN T.VALUE_DATA ELSE 0 END ) '融资主体',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPropertyDebtInvestmentPlansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskPropertyDebtInvestmentPlansProductName',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansCreditRatingsForAssets',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansIssuer',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansFinancingBody',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansAdmittedValue',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansInterestReceivable',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansRiskExposure',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansBaseRiskFactor',
   'CounterpartyDefaultRiskPropertyDebtInvestmentPlansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,2,3,,,,,,,,,,,,,,,,,
relation:hold-company-product,1,4,5,6,7,8,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,,,,,,,,,,
CounterpartyDefaultRiskProjectAssetBackedPlansAbstract,CounterpartyDefaultRiskProjectAssetBackedPlansAbstract,CounterpartyDefaultRiskProjectAssetBackedPlansProductName,CounterpartyDefaultRiskProjectAssetBackedPlansCreditRatingsForAssets,CounterpartyDefaultRiskProjectAssetBackedPlansIssuer,CounterpartyDefaultRiskProjectAssetBackedPlansFinancingBody,CounterpartyDefaultRiskProjectAssetBackedPlansAdmittedValue,CounterpartyDefaultRiskProjectAssetBackedPlansInterestReceivable,CounterpartyDefaultRiskProjectAssetBackedPlansRiskExposure,CounterpartyDefaultRiskProjectAssetBackedPlansBaseRiskFactor,CounterpartyDefaultRiskProjectAssetBackedPlansMinimumCapital,,,,,,,,,,
CR13-交易对手违约风险，项目资产支持计划 [abstract],CR13-交易对手违约风险，项目资产支持计划 [abstract],产品名称,资产的信用评级,发行机构,融资主体,认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansFinancingBody' THEN T.VALUE_DATA ELSE 0 END ) '融资主体',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskProjectAssetBackedPlansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskProjectAssetBackedPlansProductName',
   'CounterpartyDefaultRiskProjectAssetBackedPlansCreditRatingsForAssets',
   'CounterpartyDefaultRiskProjectAssetBackedPlansIssuer',
   'CounterpartyDefaultRiskProjectAssetBackedPlansFinancingBody',
   'CounterpartyDefaultRiskProjectAssetBackedPlansAdmittedValue',
   'CounterpartyDefaultRiskProjectAssetBackedPlansInterestReceivable',
   'CounterpartyDefaultRiskProjectAssetBackedPlansRiskExposure',
   'CounterpartyDefaultRiskProjectAssetBackedPlansBaseRiskFactor',
   'CounterpartyDefaultRiskProjectAssetBackedPlansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,2,3,,,,,,,,,,,,,,,,,
relation:hold-company-product,1,4,5,6,7,8,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingAbstract,ForwardForeignExchangeContractsMember-InterestRateSwapsMember,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingContractName,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingIssuer,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingCreditRatingsForAssets,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingNetValue,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingRiskExposure,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingBaseRiskFactor,CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingMinimumCapital,,,,,,,,,,,,
CR14-交易对手违约风险，套期保值外汇远期和利率互换 [abstract],外汇远期 [member]-利率互换 [member],合约名称,发行机构,资产的信用评级,债权净额,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingContractName' THEN T.VALUE_DATA ELSE 0 END ) '合约名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingCreditRatingsForAssets' THEN T.VALUE_DATA ELSE 0 END ) '资产的信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingNetValue' THEN T.VALUE_DATA ELSE 0 END ) '债权净额',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingContractName',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingIssuer',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingCreditRatingsForAssets',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingNetValue',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingRiskExposure',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingBaseRiskFactor',
   'CounterpartyDefaultRiskForwardForeignExchangeContractsAndInterestRateSwapsForPurposeOfHedgingMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
 AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat(OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:contract,0,1,,,,,,,,,,,,,,,,,,
relation:hold-company-contract,2,3,4,5,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,,,,,,
CounterpartyDefaultRiskOfPropertyAndCasualtyInsuranceCompanyAndLifeInsuranceCompanyOutwardReinsuranceAssetsAbstract,DomesticInwardReinsurerMember-OverseasInwardReinsurerMember-OverseasInwardReinsurerSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsMember-OverseasInwardReinsurerSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsMember,CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName,CounterpartyDefaultRiskOutwardReinsuranceAssetsDomesticIndependentLegalEntityOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio,CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsOverseasInwardReinsurerIsParentCompanyOrRelatedPartyOfDomesticOutwardReinsurerOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable,CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable,CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets,CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor,CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne,CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorTwo,CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital,,,,,,
CR15-财险和人身险公司交易对手违约风险，分出业务再保险资产 [abstract],境内再保分入人 [member]-境外再保分入人 [member]-各级偿付能力充足率全部达到监管要求 [member]-各级偿付能力充足率未全部达到监管要求 [member],再保分入人名称,是否为境内独立法人机构,偿付能力充足率,是否有担保措施,是否为寿险业务修正共保业务,是否为母公司/关联机构,应收分保准备金,应收分保款项,风险暴露,基础因子RF0,特征系数K1,特征系数K2,最低资本,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName' THEN T.VALUE_DATA ELSE 0 END ) '再保分入人名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsDomesticIndependentLegalEntityOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否为境内独立法人机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio' THEN T.VALUE_DATA ELSE 0 END ) '偿付能力充足率',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否有担保措施',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否为寿险业务修正共保业务',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsOverseasInwardReinsurerIsParentCompanyOrRelatedPartyOfDomesticOutwardReinsurerOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否为母公司/关联机构',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收分保准备金',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收分保款项',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorTwo' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'


FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsDomesticIndependentLegalEntityOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsOverseasInwardReinsurerIsParentCompanyOrRelatedPartyOfDomesticOutwardReinsurerOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorTwo',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
 AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:reinsurance,0,1,5,7,11,,,,,,,,,,,,,,,
relation:hold-company-reinsurance,2,3,4,6,8,9,10,12,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,,,,,,,,
CounterpartyDefaultRiskOfReinsuranceCompanyOutwardReinsuranceAssetsAbstract,DomesticInwardReinsurerMember-OverseasInwardReinsurerMember,CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName,CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio,CounterpartyDefaultRiskOutwardReinsuranceAssetsCreditRatingOfOverseasInwardReinsurer,CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot,CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable,CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable,CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets,CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor,CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne,CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital,,,,,,,,
CR16-再保险公司交易对手违约风险，分出业务再保险资产 [abstract],境内再保分入人 [member]-境外再保分入人 [member],再保分入人名称,偿付能力充足率,信用评级,是否有担保措施,是否为寿险业务修正共保业务,应收分保准备金,应收分保款项,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName' THEN T.VALUE_DATA ELSE 0 END ) '再保分入人名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio' THEN T.VALUE_DATA ELSE 0 END ) '偿付能力充足率',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsCreditRatingOfOverseasInwardReinsurer' THEN T.VALUE_DATA ELSE 0 END ) '信用评级',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否有担保措施',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot' THEN T.VALUE_DATA ELSE 0 END ) '是否为寿险业务修正共保业务',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收分保准备金',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收分保款项',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'


FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskOutwardReinsuranceAssetsInwardReinsurerName',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsSolvencyAdequacyRatio',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsCreditRatingOfOverseasInwardReinsurer',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsGuaranteeMeasuresInPlaceOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsModifiedCoinsuranceBusinessOfLifeInsuranceBusinessOrNot',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsAdmittedValueOfReinsuranceReserveReceivable',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsNetValueOfReinsuranceReceivable',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskExposureOfReinsuranceAssets',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsBaseRiskFactor',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsRiskFactorOne',
   'CounterpartyDefaultRiskOutwardReinsuranceAssetsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
 AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))
) T
GROUP BY T.DIM_GID


",,,,,,,,,,,,,,,,,,,
node:reinsurance,0,4,6,9,,,,,,,,,,,,,,,,
relation:hold-company-reinsurance,1,2,3,5,7,8,10,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
CounterpartyDefaultRiskInwardReinsuranceAssetsAbstract,CounterpartyDefaultRiskInwardReinsuranceAssetsAbstract,CounterpartyDefaultRiskInwardReinsuranceAssetsOutwardReinsurerName,CounterpartyDefaultRiskInwardReinsuranceAssetsRangeOfAccountAge,CounterpartyDefaultRiskInwardReinsuranceAssetsNetValue,CounterpartyDefaultRiskInwardReinsuranceAssetsRiskExposure,CounterpartyDefaultRiskInwardReinsuranceAssetsBaseRiskFactor,CounterpartyDefaultRiskInwardReinsuranceAssetsMinimumCapital,,,,,,,,,,,,,
CR17-交易对手违约风险，分入业务再保险资产 [abstract],CR17-交易对手违约风险，分入业务再保险资产 [abstract],分出人（交易对手）名称,账龄所属范围,债权净额,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsOutwardReinsurerName' THEN T.VALUE_DATA ELSE 0 END ) '分出人（交易对手）名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsRangeOfAccountAge' THEN T.VALUE_DATA ELSE 0 END ) '账龄所属范围',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsNetValue' THEN T.VALUE_DATA ELSE 0 END ) '债权净额',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskInwardReinsuranceAssetsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskInwardReinsuranceAssetsOutwardReinsurerName',
   'CounterpartyDefaultRiskInwardReinsuranceAssetsRangeOfAccountAge',
   'CounterpartyDefaultRiskInwardReinsuranceAssetsNetValue',
   'CounterpartyDefaultRiskInwardReinsuranceAssetsRiskExposure',
   'CounterpartyDefaultRiskInwardReinsuranceAssetsBaseRiskFactor',
   'CounterpartyDefaultRiskInwardReinsuranceAssetsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:reinsurance,0,,,,,,,,,,,,,,,,,,,
relation:hold-company-reinsurance,1,2,3,4,5,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,,,,,,,,,,,,,,,
CounterpartyDefaultRiskPremiumReceivableAbstract,AgricultureInsuranceAndMajorIllnessInsuranceForUrbanAndRuralResidentsUnderCooperationWithGovernmentsAtDifferentLevelsWhichAreEntitledToGovernmentalPremiumSubsidiesMember-AgricultureInsuranceAndMajorIllnessInsuranceForUrbanAndRuralResidentsUnderCooperationWithGovernmentsAtDifferentLevelsWhichAreEntitledToGovernmentalPremiumSubsidiesNoMoreThanNineMonthsMember-AgricultureInsuranceAndMajorIllnessInsuranceForUrbanAndRuralResidentsUnderCooperationWithGovernmentsAtDifferentLevelsWhichAreEntitledToGovernmentalPremiumSubsidiesNineMonthsToTwelveMonthsIncludingTwelveMonthsMember-AgricultureInsuranceAndMajorIllnessInsuranceForUrbanAndRuralResidentsUnderCooperationWithGovernmentsAtDifferentLevelsWhichAreEntitledToGovernmentalPremiumSubsidiesTwelveMonthsToEighteenMonthsIncludingEighteenMonthsMember-AgricultureInsuranceAndMajorIllnessInsuranceForUrbanAndRuralResidentsUnderCooperationWithGovernmentsAtDifferentLevelsWhichAreEntitledToGovernmentalPremiumSubsidiesMoreThanEighteenMonthsMember-OtherPremiumReceivableBusinessMember-OtherPremiumReceivableBusinessNoMoreThanSixMonthsMember-OtherPremiumReceivableBusinessSixMonthsToTwelveMonthsIncludingTwelveMonthsMember-OtherPremiumReceivableBusinessMoreThanTwelveMonthsMember-ReceivablesAndPrepaymentsInConnectionWithInsuranceBusinessFailingToPassMaterialInsuranceRiskTestMember-ReceivablesAndPrepaymentsInConnectionWithInsuranceBusinessFailingToPassMaterialInsuranceRiskTestNoMoreThanSixMonthsMember-ReceivablesAndPrepaymentsInConnectionWithInsuranceBusinessFailingToPassMaterialInsuranceRiskTestSixMonthsToTwelveMonthsIncludingTwelveMonthsMember-ReceivablesAndPrepaymentsInConnectionWithInsuranceBusinessFailingToPassMaterialInsuranceRiskTestMoreThanTwelveMonthsMember,CounterpartyDefaultRiskPremiumReceivableAdmittedValue,CounterpartyDefaultRiskPremiumReceivableRiskExposure,CounterpartyDefaultRiskPremiumReceivableBaseRiskFactor,CounterpartyDefaultRiskPremiumReceivableMinimumCapital,,,,,,,,,,,,,,,
CR18-交易对手违约风险，应收保费 [abstract],农业保险、与各级政府合作的城乡居民大病保险等享受各级政府保费补贴的业务 [member]-不大于9个月 [member]-（9个月，12个月] [member]-（12个月，18个月] [member]-18个月以上 [member]-其他业务 [member]-不大于6个月 [member]-（6个月，12个月] [member]-12个月以上 [member]-未通过重大保险风险测试的保险业务所对应的应收及预付款项 [member]-不大于6个月 [member]-（6个月，12个月] [member]-12个月以上 [member],认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPremiumReceivableAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPremiumReceivableRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPremiumReceivableBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPremiumReceivableMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskPremiumReceivableAdmittedValue',
   'CounterpartyDefaultRiskPremiumReceivableRiskExposure',
   'CounterpartyDefaultRiskPremiumReceivableBaseRiskFactor',
   'CounterpartyDefaultRiskPremiumReceivableMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND AXIS_COUNT = 1)
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsAbstract,layer,CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsCounterpartyName,CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsNetValue,CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsRiskExposure,CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsBaseRiskFactor,CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsMinimumCapital,,,,,,,,,,,,,,
CR19-交易对手违约风险，其他应收及预付款项 [abstract],layer,交易对手名称,债权净额,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,
layer,PrepaidIndemnitiesAndPrepaidTaxesToBeWithheldMember-OtherReceivablesAndPrepaymentsOthersMember,,,,,,,,,,,,,,,,,,,
layer_zh,预付赔款、待抵扣的预交税费 [member]-其他应收及预付款项 [member],,,,,,,,,,,,,,,,,,,
layer,CounterpartyOneMember-CounterpartyTwoMember-CounterpartyThreeMember-CounterpartyFourMember-CounterpartyFiveMember-CounterpartySixMember-CounterpartySevenMember-CounterpartyEightMember-CounterpartyNineMember-CounterpartyTenMember-OtherCounterpartiesMember,,,,,,,,,,,,,,,,,,,
layer_zh,交易对手一 [member]-交易对手二 [member]-交易对手三 [member]-交易对手四 [member]-交易对手五 [member]-交易对手六 [member]-交易对手七 [member]-交易对手八 [member]-交易对手九 [member]-交易对手十 [member]-其他交易对手 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsCounterpartyName' THEN T.VALUE_DATA ELSE 0 END ) '交易对手名称',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsNetValue' THEN T.VALUE_DATA ELSE 0 END ) '债权净额',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsCounterpartyName',
   'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsNetValue',
   'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsRiskExposure',
   'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsBaseRiskFactor',
   'CounterpartyDefaultRiskOtherReceivablesAndPrepaymentsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T
GROUP BY T.DIM_GID","  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                    AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                   )",,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
CounterpartyDefaultRiskDebtGuaranteeAbstract,CounterpartyOneMember-CounterpartyTwoMember-CounterpartyThreeMember-CounterpartyFourMember-CounterpartyFiveMember-CounterpartySixMember-CounterpartySevenMember-CounterpartyEightMember-CounterpartyNineMember-CounterpartyTenMember-OtherCounterpartiesMember,CounterpartyDefaultRiskDebtGuaranteeGuaranteedPartyName,CounterpartyDefaultRiskDebtGuaranteeAmountOfGuarantee,CounterpartyDefaultRiskDebtGuaranteeRiskExposure,CounterpartyDefaultRiskDebtGuaranteeBaseRiskFactor,CounterpartyDefaultRiskDebtGuaranteeMinimumCapital,,,,,,,,,,,,,,
CR20-交易对手违约风险，债务担保 [abstract],交易对手一 [member]-交易对手二 [member]-交易对手三 [member]-交易对手四 [member]-交易对手五 [member]-交易对手六 [member]-交易对手七 [member]-交易对手八 [member]-交易对手九 [member]-交易对手十 [member]-其他交易对手 [member],被担保方,担保金额,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskDebtGuaranteeGuaranteedPartyName' THEN T.VALUE_DATA ELSE 0 END ) '被担保方',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskDebtGuaranteeAmountOfGuarantee' THEN T.VALUE_DATA ELSE 0 END ) '担保金额',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskDebtGuaranteeRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskDebtGuaranteeBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskDebtGuaranteeMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskDebtGuaranteeGuaranteedPartyName',
   'CounterpartyDefaultRiskDebtGuaranteeAmountOfGuarantee',
   'CounterpartyDefaultRiskDebtGuaranteeRiskExposure',
   'CounterpartyDefaultRiskDebtGuaranteeBaseRiskFactor',
   'CounterpartyDefaultRiskDebtGuaranteeMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE AXIS_VALUE = '0000154976' AND MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND AXIS_COUNT = 1)
) T
GROUP BY T.DIM_GID

",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
CounterpartyDefaultRiskPolicyLoansAbstract,TraditionalInsuranceExcludingHighInterestRatePolicyAccountMember-ParticipatingInsuranceAccountMember-UniversalInsuranceAccountMember-HighInterestRatePolicyAccountMember-OtherInsuranceAccountMember,CounterpartyDefaultRiskPolicyLoansAdmittedValue,CounterpartyDefaultRiskPolicyLoansInterestReceivable,CounterpartyDefaultRiskPolicyLoansRiskExposure,CounterpartyDefaultRiskPolicyLoansBaseRiskFactor,CounterpartyDefaultRiskPolicyLoansMinimumCapital,,,,,,,,,,,,,,
CR21-交易对手违约风险，保单质押贷款 [abstract],传统险（不含高利率保单） [member]-分红险 [member]-万能险 [member]-高利率保单 [member]-其他险 [member],认可价值,应收利息,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPolicyLoansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPolicyLoansInterestReceivable' THEN T.VALUE_DATA ELSE 0 END ) '应收利息',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPolicyLoansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPolicyLoansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'CounterpartyDefaultRiskPolicyLoansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('CounterpartyDefaultRiskPolicyLoansAdmittedValue',
    'CounterpartyDefaultRiskPolicyLoansInterestReceivable',
    'CounterpartyDefaultRiskPolicyLoansRiskExposure',
    'CounterpartyDefaultRiskPolicyLoansBaseRiskFactor',
    'CounterpartyDefaultRiskPolicyLoansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE AXIS_VALUE = '0000157443' AND MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND AXIS_COUNT = 1)
) T
GROUP BY T.DIM_GID

",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
InterestRateRiskOfLifeInsuranceCompanyAbstract,TraditionalInsuranceExcludingHighInterestRatePolicyAccountMember-ParticipatingInsuranceAccountMember-UniversalInsuranceAccountMember-UnitLinkedInsuranceIncludingOtherInsuranceAccountMember-HighInterestRatePolicyAccountMember-ShareholdersAccountAndOtherAccountMember,AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario,AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates,LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates,AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates,LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates,MarketRiskMinimumCapitalForInterestRateRisk,RatioOfInvestmentAssetsAtCostToTotalInvestmentAssets,,,,,,,,,
MR01-人身保险公司利率风险 [abstract],传统险（不含高利率保单） [member]-分红险 [member]-万能险 [member]-投连险（含其他） [member]-高利率保单 [member]-股东账户及其他 [member],AA基础情景,PV基础情景,AA利率下降情景,PV利率下降情景,利率下降情景最低资本,AA利率上升情景,PV利率上升情景,利率上升情景最低资本,利率风险最低资本,投资资产中以成本计价资产占比,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario' THEN T.VALUE_DATA ELSE 0 END ) 'AA基础情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario' THEN T.VALUE_DATA ELSE 0 END ) 'PV基础情景',
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'AA利率下降情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'PV利率下降情景',
MAX(CASE T.ELE_NAME WHEN 'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) '利率下降情景最低资本',
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'AA利率上升情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'PV利率上升情景',
MAX(CASE T.ELE_NAME WHEN 'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) '利率上升情景最低资本',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForInterestRateRisk' THEN T.VALUE_DATA ELSE 0 END ) '利率风险最低资本',
MAX(CASE T.ELE_NAME WHEN 'RatioOfInvestmentAssetsAtCostToTotalInvestmentAssets' THEN T.VALUE_DATA ELSE 0 END ) '投资资产中以成本计价资产占比'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario','PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario',
         'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates','LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates',
         'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates',
         'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates',
         'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates',
         'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates',
         'MarketRiskMinimumCapitalForInterestRateRisk','RatioOfInvestmentAssetsAtCostToTotalInvestmentAssets') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T
",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,,,,,,,,
InterestRateRiskOfReinsuranceCompanyAbstract,TraditionalInsuranceExcludingHighInterestRatePolicyAccountMember-ParticipatingInsuranceAccountMember-UniversalInsuranceAccountMember-UnitLinkedInsuranceIncludingOtherInsuranceAccountMember-HighInterestRatePolicyAccountMember-ShareholdersAccountAndOtherAccountMember,AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario,AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates,LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates,AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates,PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates,LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates,InterestRateRiskOfLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital,InterestRateRiskOfNonLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital,MarketRiskMinimumCapitalForInterestRateRisk,,,,,,,,
MR02-再保险公司利率风险 [abstract],传统险（不含高利率保单） [member]-分红险 [member]-万能险 [member]-投连险（含其他） [member]-高利率保单 [member]-股东账户及其他 [member],AA基础情景,PV基础情景,AA利率下降情景,PV利率下降情景,寿险业务利率下降情景最低资本,AA利率上升情景,PV利率上升情景,寿险业务利率上升情景最低资本,寿险业务利率风险最低资本,非寿险业务利率风险最低资本,再保险公司利率风险最低资本,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario' THEN T.VALUE_DATA ELSE 0 END ) 'AA基础情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario' THEN T.VALUE_DATA ELSE 0 END ) 'PV基础情景',
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'AA利率下降情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'PV利率下降情景',
MAX(CASE T.ELE_NAME WHEN 'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) '寿险业务利率下降情景最低资本',
MAX(CASE T.ELE_NAME WHEN 'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'AA利率上升情景',
MAX(CASE T.ELE_NAME WHEN 'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) 'PV利率上升情景',
MAX(CASE T.ELE_NAME WHEN 'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates' THEN T.VALUE_DATA ELSE 0 END ) '寿险业务利率上升情景最低资本',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOfLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '寿险业务利率风险最低资本',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOfNonLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '非寿险业务利率风险最低资本',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForInterestRateRisk' THEN T.VALUE_DATA ELSE 0 END ) '再保险公司利率风险最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'AdmittedValueOfAdmittedAssetsOnValuationDateBaseScenario','PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateBaseScenario',
         'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfDecreasingInterestRates','LifeInsuranceBusinessMinimumCapitalUnderScenariosOfDecreasingInterestRates',
   'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfDecreasingInterestRates',
         'AdmittedValueOfAdmittedAssetsOnValuationDateAdverseScenarioOfIncreasingInterestRates','VariationOfCombinedRatio',
         'PresentValueOfCashFlowsOfLifeInsuranceBusinessCalculatedAfterConsiderationOfReinsuranceFactorsOnValuationDateAdverseScenarioOfIncreasingInterestRates',
         'LifeInsuranceBusinessMinimumCapitalUnderScenariosOfIncreasingInterestRates',
   'InterestRateRiskOfNonLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital',
         'MarketRiskMinimumCapitalForInterestRateRisk','InterestRateRiskOfLifeInsuranceBusinessOfReinsuranceCompanyMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T



",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingAbstract,layer,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondName,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondCode,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingModifiedDuration,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingAdmittedValue,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingRiskExposure,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBaseRiskFactor,InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingMinimumCapital,,,,,,,,,,,,
MR03-利率风险，债券类资产（未套保及不符合条件的套保） [abstract],layer,债券名称,债券代码,修正久期（年）,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
layer,"HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember
",,,,,,,,,,,,,,,,,,,
layer_zh,"公司直接持有 [member]-穿透法还原后持有 [member]
",,,,,,,,,,,,,,,,,,,
layer,GovernmentBondsUnderSolvencyIIMember-QuasiGovernmentBondsMember-FinancialBondsUnderSolvencyIIMember-EnterpriseBondsCorporateBondsMember,,,,,,,,,,,,,,,,,,,
layer_zh,政府债 [member]-准政府债 [member]-金融债 [member]-企业（公司）债 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondName' THEN T.VALUE_DATA ELSE 0 END ) '债券名称',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondCode' THEN T.VALUE_DATA ELSE 0 END ) '债券代码',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingModifiedDuration' THEN T.VALUE_DATA ELSE 0 END ) '修正久期（年）',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondName',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBondCode',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingModifiedDuration',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingAdmittedValue',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingRiskExposure',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingBaseRiskFactor',
    'InterestRateRiskBondAssetsNoHedgingAndUnqualifiedHedgingMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:bond,0,1,,,,,,,,,,,,,,,,,,
relation:buy-company-bond,2,3,4,5,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
InterestRateRiskAssetSecuritizationProductsAbstract,layer,InterestRateRiskAssetSecuritizationProductsProductName,InterestRateRiskAssetSecuritizationProductsProductCode,InterestRateRiskAssetSecuritizationProductsModifiedDuration,InterestRateRiskAssetSecuritizationProductsAdmittedValue,InterestRateRiskAssetSecuritizationProductsRiskExposure,InterestRateRiskAssetSecuritizationProductsBaseRiskFactor,InterestRateRiskAssetSecuritizationProductsMinimumCapital,,,,,,,,,,,,
MR04-利率风险，资产证券化产品 [abstract],layer,产品名称,产品代码,修正久期（年）,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
layer,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member]-穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,SpecialAssetManagementPlansOfSecuritiesCompanyMember-CreditAssetBackedSecuritiesMember,,,,,,,,,,,,,,,,,,,
layer_zh,证券公司专项管理计划 [member]-信贷资产支持证券 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansProductCode' THEN T.VALUE_DATA ELSE 0 END ) '产品代码',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskInfrastructureEquityInvestmentPlansMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('EquityPriceRiskInfrastructureEquityInvestmentPlansProductName',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansProductCode',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansPurchaseCost',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansAdmittedValue',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansRiskExposure',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansBaseRiskFactor',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T
GROUP BY T.DIM_GID","  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:security,0,1,,,,,,,,,,,,,,,,,,
relation:buy-company-security,2,3,4,5,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
InterestRateRiskInterestRateDerivativesInterestRateSwapsAbstract,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,InterestRateRiskInterestRateDerivativesInterestRateSwapsContractName,InterestRateRiskInterestRateDerivativesInterestRateSwapsTypesOfContract,InterestRateRiskInterestRateDerivativesInterestRateSwapsModifiedDuration,InterestRateRiskInterestRateDerivativesInterestRateSwapsNominalPrincipal,InterestRateRiskInterestRateDerivativesInterestRateSwapsRiskExposure,InterestRateRiskInterestRateDerivativesInterestRateSwapsBaseRiskFactor,InterestRateRiskInterestRateDerivativesInterestRateSwapsMinimumCapital,,,,,,,,,,,,
MR05-利率风险，利率类金融衍生品，利率互换 [abstract],公司直接持有 [member]-穿透法还原后持有 [member],合约名称,合约类型,修正久期（年）,名义本金,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsContractName' then T.VALUE_DATA else 0 end ) '合约名称',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsTypesOfContract' then T.VALUE_DATA else 0 end ) '合约类型',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsModifiedDuration' then T.VALUE_DATA else 0 end ) '修正久期（年）',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsNominalPrincipal' then T.VALUE_DATA else 0 end ) '名义本金',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesInterestRateSwapsMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ( 'InterestRateRiskInterestRateDerivativesInterestRateSwapsContractName',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsTypesOfContract', 
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsModifiedDuration',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsNominalPrincipal',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsRiskExposure',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsBaseRiskFactor' ,
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(OID , '%%') from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:contract,0,1,,,,,,,,,,,,,,,,,,
relation:hold-company-contract,2,3,4,5,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,,,,,,
InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingAbstract,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingAbstract,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingHedgingPortfolioName,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityName,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityCode,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingModifiedDurationOfBonds,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingAdmittedValueOfBonds,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingModifiedDurationOfShortPositionOfGovernmentBondFutures,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingContractualValueOfShortPositionOfGovernmentBondFutures,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingHedgingEffectivenessOfShortPositionOfGovernmentBondFutures,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingRiskExposureOfHedgedBonds,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingBaseRiskFactorOfHedgedBonds,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingRiskFactorOfShortPositionOfGovernmentBondFutures,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingMinimumCapitalOfHedgedBondPortfolio,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingMinimumCapitalOfHedgingPortfolio,,,,,,
MR06-利率风险，利率类金融衍生品，国债期货（符合条件套保） [abstract],MR06-利率风险，利率类金融衍生品，国债期货（符合条件套保） [abstract],套期组合名称,证券名称,证券代码,债券的修正久期（年）,债券的认可价值,空头合约修正久期（年）,空头合约价值,套期有效性,债券的风险暴露,债券的基础因子RF0,空头合约的风险因子RF,组合中债券的最低资本,套期组合最低资本,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingHedgingPortfolioName' then T.VALUE_DATA else 0 end ) '套期组合名称',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityName' then T.VALUE_DATA else 0 end ) '证券名称',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityCode' then T.VALUE_DATA else 0 end ) '证券代码',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingModifiedDurationOfBonds' then T.VALUE_DATA else 0 end ) '债券的修正久期（年）',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingAdmittedValueOfBonds' then T.VALUE_DATA else 0 end ) '债券的认可价值',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingModifiedDurationOfShortPositionOfGovernmentBondFutures' then T.VALUE_DATA else 0 end ) '空头合约修正久期（年）',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingHedgingEffectivenessOfShortPositionOfGovernmentBondFutures' then T.VALUE_DATA else 0 end ) '空头合约价值',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingRiskExposureOfHedgedBonds' then T.VALUE_DATA else 0 end ) '套期有效性',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingBaseRiskFactorOfHedgedBonds' then T.VALUE_DATA else 0 end ) '债券的风险暴露',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingRiskFactorOfShortPositionOfGovernmentBondFutures' then T.VALUE_DATA else 0 end ) '债券的基础因子RF0',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingContractualValueOfShortPositionOfGovernmentBondFutures' then T.VALUE_DATA else 0 end ) '空头合约的风险因子RF',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingMinimumCapitalOfHedgedBondPortfolio' then T.VALUE_DATA else 0 end ) '组合中债券的最低资本',
Max(case T.ELE_NAME when 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingMinimumCapitalOfHedgingPortfolio' then T.VALUE_DATA else 0 end ) '套期组合最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ( 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingHedgingPortfolioName',
    'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityName', 
    'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingSecurityCode',
    'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesQualifiedHedgingModifiedDurationOfBonds',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsRiskExposure',
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsBaseRiskFactor' ,
    'InterestRateRiskInterestRateDerivativesInterestRateSwapsMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
   AND  DIM_GID = ' '
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:security,0,1,2,7,,,,,,,,,,,,,,,,
relation:buy-company-security,3,4,5,6,8,9,10,11,12,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingAbstract,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingAbstract,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingAssetName,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingContractualValueOfShortPositionOfGovernmentBondFutures,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingModifiedDuration,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingRiskFactor,InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingMinimumCapital,,,,,,,,,,,,,,
MR07-利率风险，利率类金融衍生品，国债期货（不符合条件套保） [abstract],MR07-利率风险，利率类金融衍生品，国债期货（不符合条件套保） [abstract],资产名称,国债期货空头合约价值,修正久期（年）,风险因子RF,最低资本,,,,,,,,,,,,,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingAssetName' THEN T.VALUE_DATA ELSE 0 END ) '资产名称',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingContractualValueOfShortPositionOfGovernmentBondFutures' THEN T.VALUE_DATA ELSE 0 END ) '国债期货空头合约价值',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingModifiedDuration' THEN T.VALUE_DATA ELSE 0 END ) '修正久期（年）',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '风险因子RF',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingAssetName',
        'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingContractualValueOfShortPositionOfGovernmentBondFutures',
        'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingModifiedDuration',
        'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingRiskFactor',
        'InterestRateRiskInterestRateDerivativesGovernmentBondFuturesUnqualifiedHedgingMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:security,0,,,,,,,,,,,,,,,,,,,
relation:buy-company-security,1,2,3,4,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
InterestRateRiskOtherFixedIncomeProductsAbstract,InterestRateRiskOtherFixedIncomeProductsAbstract,InterestRateRiskOtherFixedIncomeProductsAssetName,InterestRateRiskOtherFixedIncomeProductsModifiedDuration,InterestRateRiskOtherFixedIncomeProductsAdmittedValue,InterestRateRiskOtherFixedIncomeProductsRiskExposure,InterestRateRiskOtherFixedIncomeProductsBaseRiskFactor,InterestRateRiskOtherFixedIncomeProductsMinimumCapital,,,,,,,,,,,,,
MR08-利率风险，其他固定收益类产品 [abstract],MR08-利率风险，其他固定收益类产品 [abstract],资产名称,修正久期（年）,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
sql,"
SELECT 
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsAssetName' THEN T.VALUE_DATA ELSE 0 END ) '资产名称',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsModifiedDuration' THEN T.VALUE_DATA ELSE 0 END ) '修正久期（年）',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'InterestRateRiskOtherFixedIncomeProductsAssetName' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('InterestRateRiskOtherFixedIncomeProductsAdmittedValue','InterestRateRiskOtherFixedIncomeProductsModifiedDuration',
        'InterestRateRiskOtherFixedIncomeProductsAdmittedValue','InterestRateRiskOtherFixedIncomeProductsRiskExposure',
        'InterestRateRiskOtherFixedIncomeProductsBaseRiskFactor','InterestRateRiskOtherFixedIncomeProductsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:product,0,,,,,,,,,,,,,,,,,,,
relation:buy-company-product,1,2,3,4,5,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,,,,,,,
EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingAbstract,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockName,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockCode,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingTypesOfStock,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingWhetherStockIsCompositeOfCsi300Index,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingProportionOfOwnershipInterests,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingPurchaseCost,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingAdmittedValue,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskExposure,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingBaseRiskFactor,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorOne,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorTwo,EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingMinimumCapital,,,,,,,
MR09-权益价格风险，股票（未套保及不符合条件的套保） [abstract],公司直接持有 [member]-穿透法还原后持有 [member],股票名称,股票代码,股票类型,是否为沪深300指数成份股,持股比例,购买成本,认可价值,风险暴露,基础因子RF0,特征系数K1,特征系数K2,最低资本,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockName' then T.VALUE_DATA else 0 end ) '股票名称',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockCode' then T.VALUE_DATA else 0 end ) '股票代码',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingTypesOfStock' then T.VALUE_DATA else 0 end ) '股票类型',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingProportionOfOwnershipInterests' then T.VALUE_DATA else 0 end ) '持股比例',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingWhetherStockIsCompositeOfCsi300Index' then T.VALUE_DATA else 0 end ) '是否为沪深300指数成份股',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingBaseRiskFactor' then T.VALUE_DATA else 0 end ) 'RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorOne' then T.VALUE_DATA else 0 end ) '特征系数K1',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorTwo' then T.VALUE_DATA else 0 end ) '特征系数K2',
Max(case T.ELE_NAME when 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ( 'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockName',-- 股票名称
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingStockCode', -- 股票代码
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingTypesOfStock',--  股票类型
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingProportionOfOwnershipInterests',--   持股比例
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingPurchaseCost',--  购买成本
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskExposure' --   风险暴露
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingWhetherStockIsCompositeOfCsi300Index',--  是否为沪深300指数成份股
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingAdmittedValue',-- 认可价值
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingBaseRiskFactor', --  RF0
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorOne', --  特征系数K1
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingRiskFactorTwo', -- 特征系数K2
    'EquityPriceRiskStockNoHedgingAndUnqualifiedHedgingMinimumCapital' -- 最低资本
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""%%"",OID ) from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:stock,0,1,2,,,,,,,,,,,,,,,,,
relation:buy-member-stock,3,4,5,6,7,8,9,10,11,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,,
EquityPriceRiskStockQualifiedHedgingAbstract,EquityPriceRiskStockQualifiedHedgingAbstract,EquityPriceRiskStockQualifiedHedgingHedgingPortfolioName,EquityPriceRiskStockQualifiedHedgingStockName,EquityPriceRiskStockQualifiedHedgingStockCode,EquityPriceRiskStockQualifiedHedgingTypesOfStock,EquityPriceRiskStockQualifiedHedgingWhetherStockIsCompositeOfCsi300Index,EquityPriceRiskStockQualifiedHedgingProportionOfOwnershipInterests,EquityPriceRiskStockQualifiedHedgingPurchaseCost,EquityPriceRiskStockQualifiedHedgingAdmittedValue,EquityPriceRiskStockQualifiedHedgingContractualValueOfShortPositionOfStockIndexFutures,EquityPriceRiskStockQualifiedHedgingHedgingEffectivenessOfShortPositionOfStockIndexFutures,EquityPriceRiskStockQualifiedHedgingRiskExposureOfHedgedStock,EquityPriceRiskStockQualifiedHedgingBaseRiskFactorOfHedgedStock,EquityPriceRiskStockQualifiedHedgingRiskFactorOneOfHedgedStock,EquityPriceRiskStockQualifiedHedgingRiskFactorTwoOfHedgedStock,EquityPriceRiskStockQualifiedHedgingRiskFactorOfShortPositionOfStockIndexFutures,EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgedStockPortfolio,EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgingPortfolio,,
MR10-权益价格风险，股票（符合条件的套期保值） [abstract],MR10-权益价格风险，股票（符合条件的套期保值） [abstract],套保组合名称,股票名称,股票代码,股票类型,是否为沪深300指数成份股,持股比例,购买成本,认可价值,空头合约价值,套期有效性,股票的风险暴露,股票的基础因子RF0,股票的特征系数K1,股票的特征系数K2,空头合约的风险因子RF,组合中股票的最低资本,套保组合最低资本,,
sql,"SELECT 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingHedgingPortfolioName' THEN T.VALUE_DATA ELSE 0 END ) '套保组合名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingStockName' THEN T.VALUE_DATA ELSE 0 END ) '股票名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingStockCode' THEN T.VALUE_DATA ELSE 0 END ) '股票代码',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingTypesOfStock' THEN T.VALUE_DATA ELSE 0 END ) '股票类型',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingWhetherStockIsCompositeOfCsi300Index' THEN T.VALUE_DATA ELSE 0 END ) '是否为沪深300指数成份股',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingProportionOfOwnershipInterests' THEN T.VALUE_DATA ELSE 0 END ) '持股比例',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingContractualValueOfShortPositionOfStockIndexFutures' THEN T.VALUE_DATA ELSE 0 END ) '空头合约价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingHedgingEffectivenessOfShortPositionOfStockIndexFutures' THEN T.VALUE_DATA ELSE 0 END ) '套期有效性',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingRiskExposureOfHedgedStock' THEN T.VALUE_DATA ELSE 0 END ) '股票的风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingBaseRiskFactorOfHedgedStock' THEN T.VALUE_DATA ELSE 0 END ) '股票的基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingRiskFactorOneOfHedgedStock' THEN T.VALUE_DATA ELSE 0 END ) '股票的特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingRiskFactorTwoOfHedgedStock' THEN T.VALUE_DATA ELSE 0 END ) '股票的特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingRiskFactorOfShortPositionOfStockIndexFutures' THEN T.VALUE_DATA ELSE 0 END ) '空头合约的风险因子RF',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgedStockPortfolio' THEN T.VALUE_DATA ELSE 0 END ) '组合中股票的最低资本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgingPortfolio' THEN T.VALUE_DATA ELSE 0 END ) '套保组合最低资本'

FROM 
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME in ('EquityPriceRiskStockQualifiedHedgingHedgingPortfolioName',
  'EquityPriceRiskStockQualifiedHedgingStockName',
'EquityPriceRiskStockQualifiedHedgingStockCode',
'EquityPriceRiskStockQualifiedHedgingTypesOfStock',
'EquityPriceRiskStockQualifiedHedgingWhetherStockIsCompositeOfCsi300Index',
'EquityPriceRiskStockQualifiedHedgingProportionOfOwnershipInterests',
'EquityPriceRiskStockQualifiedHedgingPurchaseCost',
'EquityPriceRiskStockQualifiedHedgingAdmittedValue',
'EquityPriceRiskStockQualifiedHedgingContractualValueOfShortPositionOfStockIndexFutures',
'EquityPriceRiskStockQualifiedHedgingHedgingEffectivenessOfShortPositionOfStockIndexFutures',
'EquityPriceRiskStockQualifiedHedgingRiskExposureOfHedgedStock',
'EquityPriceRiskStockQualifiedHedgingBaseRiskFactorOfHedgedStock',
'EquityPriceRiskStockQualifiedHedgingRiskFactorOneOfHedgedStock',
'EquityPriceRiskStockQualifiedHedgingRiskFactorTwoOfHedgedStock',
'EquityPriceRiskStockQualifiedHedgingRiskFactorOfShortPositionOfStockIndexFutures',
'EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgedStockPortfolio',
'EquityPriceRiskStockQualifiedHedgingMinimumCapitalOfHedgingPortfolio') --   元素名称
  AND C.PERIOD_NAME = '期末' 
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:stock,0,1,2,3,11,12,,,,,,,,,,,,,,
relation:buy-company-stock,4,5,6,7,8,9,10,13,14,15,16,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskUnlistedEquitiesAbstract,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,EquityPriceRiskUnlistedEquitiesEquitiesName,EquityPriceRiskUnlistedEquitiesProportionOfOwnershipInterests,EquityPriceRiskUnlistedEquitiesPurchaseCost,EquityPriceRiskUnlistedEquitiesAdmittedValue,EquityPriceRiskUnlistedEquitiesRiskExposure,EquityPriceRiskUnlistedEquitiesBaseRiskFactor,EquityPriceRiskUnlistedEquitiesMinimumCapital,,,,,,,,,,,,
MR11-权益价格风险，未上市股权 [abstract],公司直接持有 [member]-穿透法还原后持有 [member],股权名称,持股比例,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesEquitiesName' then T.VALUE_DATA else 0 end ) '股权名称',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesProportionOfOwnershipInterests' then T.VALUE_DATA else 0 end ) '持股比例',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquitiesMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskUnlistedEquitiesEquitiesName',
    'EquityPriceRiskUnlistedEquitiesProportionOfOwnershipInterests',
    'EquityPriceRiskUnlistedEquitiesPurchaseCost',
    'EquityPriceRiskUnlistedEquitiesAdmittedValue',
    'EquityPriceRiskUnlistedEquitiesRiskExposure',
    'EquityPriceRiskUnlistedEquitiesBaseRiskFactor',
    'EquityPriceRiskUnlistedEquitiesMinimumCapital')
  AND C.PERIOD_NAME= '期末'
   AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE   MEMBER_VALUE like (select CONCAT('%%',OID)  from psx_element where ELE_NAME ='%s') )
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:equity,0,5,,,,,,,,,,,,,,,,,,
relation:hold-company-equity,1,2,3,4,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
EquityPriceRiskSecuritiesInvestmentFundHeldByCompanyDirectlyAbstract,layer,EquityPriceRiskSecuritiesInvestmentFundFundName,EquityPriceRiskSecuritiesInvestmentFundFundCode,EquityPriceRiskSecuritiesInvestmentFundIssuer,EquityPriceRiskSecuritiesInvestmentFundHoldingNumber,EquityPriceRiskSecuritiesInvestmentFundPurchaseCost,EquityPriceRiskSecuritiesInvestmentFundAdmittedValue,EquityPriceRiskSecuritiesInvestmentFundRiskExposure,EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor,EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne,EquityPriceRiskSecuritiesInvestmentFundMinimumCapital,,,,,,,,,
MR12-权益价格风险，公司直接持有的证券投资基金 [abstract],layer,基金名称,基金代码,发行方,持仓数量（份）,购买成本,认可价值,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,,,,
layer,HeldByCompanyDirectlyMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member],,,,,,,,,,,,,,,,,,,
layer,BondFundMember-GeneralBondFundMember-HierarchicalBondFundMember-HierarchicalBondFundPreferredMember-HierarchicalBondFundSubordinatedMember-StockFundMember-GeneralStockFundMember-HierarchicalStockFundMember-HierarchicalStockFundPreferredMember-HierarchicalStockFundSubordinatedMember-HybridFundMember-MoneyMarketFundMember,,,,,,,,,,,,,,,,,,,
layer_zh,债券基金 [member]-普通债券基金 [member]-分级债券基金 [member]-分级债券基金-优先级 [member]-分级债券基金-劣后级 [member]-股票基金 [member]-普通股票基金 [member]-分级股票基金 [member]-分级股票基金-优先级 [member]-分级股票基金-劣后级 [member]-混合基金 [member]-货币市场基金 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundFundName' THEN T.VALUE_DATA ELSE 0 END ) '基金名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundFundCode' THEN T.VALUE_DATA ELSE 0 END ) '基金代码',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行方',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundHoldingNumber' THEN T.VALUE_DATA ELSE 0 END ) '持仓数量（份）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN(    'EquityPriceRiskSecuritiesInvestmentFundFundName',
   'EquityPriceRiskSecuritiesInvestmentFundFundCode',
   'EquityPriceRiskSecuritiesInvestmentFundIssuer',
   'EquityPriceRiskSecuritiesInvestmentFundHoldingNumber',
   'EquityPriceRiskSecuritiesInvestmentFundPurchaseCost',
   'EquityPriceRiskSecuritiesInvestmentFundAdmittedValue',
   'EquityPriceRiskSecuritiesInvestmentFundRiskExposure',
   'EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor',
   'EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne',
   'EquityPriceRiskSecuritiesInvestmentFundMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
 %s
) T
GROUP BY T.DIM_GID


"," AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s') AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:fund,0,1,2,7,8,,,,,,,,,,,,,,,
relation:buy-company-fund,3,4,5,6,9,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
EquityPriceRiskSecuritiesInvestmentFundHeldByLookThroughMethodAbstract,layer,EquityPriceRiskSecuritiesInvestmentFundFundName,EquityPriceRiskSecuritiesInvestmentFundFundCode,EquityPriceRiskSecuritiesInvestmentFundIssuer,EquityPriceRiskSecuritiesInvestmentFundHoldingNumber,EquityPriceRiskSecuritiesInvestmentFundPurchaseCost,EquityPriceRiskSecuritiesInvestmentFundAdmittedValue,EquityPriceRiskSecuritiesInvestmentFundRiskExposure,EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor,EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne,EquityPriceRiskSecuritiesInvestmentFundMinimumCapital,,,,,,,,,
MR13-权益价格风险，穿透法还原后持有的证券投资基金 [abstract],layer,基金名称,基金代码,发行方,持仓数量（份）,购买成本,认可价值,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,,,,
layer,HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,BondFundMember-GeneralBondFundMember-HierarchicalBondFundMember-HierarchicalBondFundPreferredMember-HierarchicalBondFundSubordinatedMember-StockFundMember-GeneralStockFundMember-HierarchicalStockFundMember-HierarchicalStockFundPreferredMember-HierarchicalStockFundSubordinatedMember-HybridFundMember-MoneyMarketFundMember,,,,,,,,,,,,,,,,,,,
layer_zh,债券基金 [member]-普通债券基金 [member]-分级债券基金 [member]-分级债券基金-优先级 [member]-分级债券基金-劣后级 [member]-股票基金 [member]-普通股票基金 [member]-分级股票基金 [member]-分级股票基金-优先级 [member]-分级股票基金-劣后级 [member]-混合基金 [member]-货币市场基金 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundFundName' THEN T.VALUE_DATA ELSE 0 END ) '基金名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundFundCode' THEN T.VALUE_DATA ELSE 0 END ) '基金代码',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundIssuer' THEN T.VALUE_DATA ELSE 0 END ) '发行方',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundHoldingNumber' THEN T.VALUE_DATA ELSE 0 END ) '持仓数量（份）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskSecuritiesInvestmentFundPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
  AND A.DWZD_BH = '%s' -- 单位
  AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'InterestRateRiskAssetSecuritizationProductsProductName','InterestRateRiskAssetSecuritizationProductsProductCode',
         'EquityPriceRiskSecuritiesInvestmentFundIssuer','EquityPriceRiskSecuritiesInvestmentFundHoldingNumber',
         'EquityPriceRiskSecuritiesInvestmentFundPurchaseCost','EquityPriceRiskSecuritiesInvestmentFundAdmittedValue',
         'EquityPriceRiskSecuritiesInvestmentFundRiskExposure','EquityPriceRiskSecuritiesInvestmentFundBaseRiskFactor',
          'EquityPriceRiskSecuritiesInvestmentFundRiskFactorOne','EquityPriceRiskSecuritiesInvestmentFundMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T

GROUP BY T.DIM_GID","  AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:fund,0,1,2,7,8,,,,,,,,,,,,,,,
relation:buy-company-fund,3,4,5,6,9,,,,,,,,,,,,,,,
end,,                    ,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskConvertibleBondAbstract,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,EquityPriceRiskConvertibleBondSecurityName,EquityPriceRiskConvertibleBondSecurityCode,EquityPriceRiskConvertibleBondPurchaseCost,EquityPriceRiskConvertibleBondAdmittedValue,EquityPriceRiskConvertibleBondRiskExposure,EquityPriceRiskConvertibleBondBaseRiskFactor,EquityPriceRiskConvertibleBondMinimumCapital,,,,,,,,,,,,
MR14-权益价格风险，可转债 [abstract],公司直接持有 [member]-穿透法还原后持有 [member],证券名称,证券代码,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondSecurityName' then T.VALUE_DATA else 0 end ) '证券名称',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondSecurityCode' then T.VALUE_DATA else 0 end ) '证券代码',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskConvertibleBondMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskConvertibleBondSecurityName',
    'EquityPriceRiskConvertibleBondSecurityCode',
    'EquityPriceRiskConvertibleBondPurchaseCost',
    'EquityPriceRiskConvertibleBondAdmittedValue',
    'EquityPriceRiskConvertibleBondRiskExposure',
    'EquityPriceRiskConvertibleBondBaseRiskFactor',
    'EquityPriceRiskConvertibleBondMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""%%"",OID) from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:convertible_bond,0,1,5,,,,,,,,,,,,,,,,,
relation:buy-company-convertible_bond,2,3,4,6,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskInfrastructureEquityInvestmentPlansAbstract,IncludingGuaranteesTermsMember-ExcludingGuaranteesTermsMember,EquityPriceRiskInfrastructureEquityInvestmentPlansProductName,EquityPriceRiskInfrastructureEquityInvestmentPlansProductCode,EquityPriceRiskInfrastructureEquityInvestmentPlansPurchaseCost,EquityPriceRiskInfrastructureEquityInvestmentPlansAdmittedValue,EquityPriceRiskInfrastructureEquityInvestmentPlansRiskExposure,EquityPriceRiskInfrastructureEquityInvestmentPlansBaseRiskFactor,EquityPriceRiskInfrastructureEquityInvestmentPlansMinimumCapital,,,,,,,,,,,,
MR15-权益价格风险，基础设施股权投资计划 [abstract],包括保证条款 [member]-不包括保证条款 [member],产品名称,产品代码,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansProductName' then T.VALUE_DATA else 0 end ) '产品名称',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansProductCode' then T.VALUE_DATA else 0 end ) '产品代码',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskInfrastructureEquityInvestmentPlansMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskInfrastructureEquityInvestmentPlansProductName',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansProductCode',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansPurchaseCost',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansAdmittedValue',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansRiskExposure',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansBaseRiskFactor',
    'EquityPriceRiskInfrastructureEquityInvestmentPlansMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""%%"",OID) from psx_element where ELE_NAME ='%s'))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:equity,0,1,,,,,,,,,,,,,,,,,,
relation:buy-company-equity,2,3,4,5,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,,,,,,,,,,,
EquityPriceRiskAssetManagementProductsAbstract,layer,EquityPriceRiskAssetManagementProductsProductName,EquityPriceRiskAssetManagementProductsProductCode,EquityPriceRiskAssetManagementProductsHoldingNumber,EquityPriceRiskAssetManagementProductsPurchaseCost,EquityPriceRiskAssetManagementProductsAdmittedValue,EquityPriceRiskAssetManagementProductsRiskExposure,EquityPriceRiskAssetManagementProductsBaseRiskFactor,EquityPriceRiskAssetManagementProductsMinimumCapital,,,,,,,,,,,
MR16-权益价格风险，资产管理产品 [abstract],layer,产品名称,产品代码,持仓数量（份）,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,
layer,UnableToBeLookedThroughMember-AbleToBeLookedThroughMember,,,,,,,,,,,,,,,,,,,
layer_zh,无法穿透 [member]-可穿透 [member],,,,,,,,,,,,,,,,,,,
layer,EquityAssetManagementProductsMember-FixedIncomeAssetManagementProductsMember-AlternativeAssetManagementProductsMember-HybridAssetManagementProductsMember,,,,,,,,,,,,,,,,,,,
layer_zh,资产管理产品-权益类 [member]-资产管理产品-固定收益类 [member]-资产管理产品-另类 [member]-资产管理产品-混合类 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsProductName' THEN T.VALUE_DATA ELSE 0 END ) '产品名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsProductCode' THEN T.VALUE_DATA ELSE 0 END ) '产品代码',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsHoldingNumber' THEN T.VALUE_DATA ELSE 0 END ) '持仓数量（份）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskAssetManagementProductsMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
  AND A.CON_ID = C.OID
  AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('EquityPriceRiskAssetManagementProductsProductName',
    'EquityPriceRiskAssetManagementProductsProductCode',
    'EquityPriceRiskAssetManagementProductsHoldingNumber',
    'EquityPriceRiskAssetManagementProductsPurchaseCost',
    'EquityPriceRiskAssetManagementProductsAdmittedValue',
    'EquityPriceRiskAssetManagementProductsRiskExposure',
    'EquityPriceRiskAssetManagementProductsBaseRiskFactor',
    'EquityPriceRiskAssetManagementProductsMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T

GROUP BY T.DIM_GID","  AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s') )",,,,,,,,,,,,,,,,,,
node:product,0,1,6,,,,,,,,,,,,,,,,,
relation:hold-company-product,2,3,4,5,7,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskUnlistedEquityInvestmentPlansAbstract,UnableToBeLookedThroughMember-AbleToBeLookedThroughMember,EquityPriceRiskUnlistedEquityInvestmentPlansProductName,EquityPriceRiskUnlistedEquityInvestmentPlansProductCode,EquityPriceRiskUnlistedEquityInvestmentPlansPurchaseCost,EquityPriceRiskUnlistedEquityInvestmentPlansAdmittedValue,EquityPriceRiskUnlistedEquityInvestmentPlansRiskExposure,EquityPriceRiskUnlistedEquityInvestmentPlansBaseRiskFactor,EquityPriceRiskUnlistedEquityInvestmentPlansMinimumCapital,,,,,,,,,,,,
MR17-权益价格风险，未上市股权投资计划 [abstract],无法穿透 [member]-可穿透 [member],产品名称,产品代码,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansProductName' then T.VALUE_DATA else 0 end ) '产品名称',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansProductCode' then T.VALUE_DATA else 0 end ) '产品代码',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskUnlistedEquityInvestmentPlansMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskUnlistedEquityInvestmentPlansProductName',
    'EquityPriceRiskUnlistedEquityInvestmentPlansProductCode',
    'EquityPriceRiskUnlistedEquityInvestmentPlansPurchaseCost',
    'EquityPriceRiskUnlistedEquityInvestmentPlansAdmittedValue',
    'EquityPriceRiskUnlistedEquityInvestmentPlansRiskExposure',
    'EquityPriceRiskUnlistedEquityInvestmentPlansBaseRiskFactor',
    'EquityPriceRiskUnlistedEquityInvestmentPlansMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""%%"",OID) from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:equity,0,1,5,,,,,,,,,,,,,,,,,
relation:buy-company-equity,2,3,4,6,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
EquityPriceRiskEquityTrustPlansAbstract,UnableToBeLookedThroughMember-AbleToBeLookedThroughMember,EquityPriceRiskEquityTrustPlansProductName,EquityPriceRiskEquityTrustPlansPurchaseCost,EquityPriceRiskEquityTrustPlansAdmittedValue,EquityPriceRiskEquityTrustPlansRiskExposure,EquityPriceRiskEquityTrustPlansBaseRiskFactor,EquityPriceRiskEquityTrustPlansMinimumCapital,,,,,,,,,,,,,
MR18-权益价格风险，权益类信托计划 [abstract],无法穿透 [member]-可穿透 [member],产品名称,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansProductName' then T.VALUE_DATA else 0 end ) '产品名称',
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansPurchaseCost' then T.VALUE_DATA else 0 end ) '购买成本',
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansAdmittedValue' then T.VALUE_DATA else 0 end ) '认可价值',
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansRiskExposure' then T.VALUE_DATA else 0 end ) '风险暴露',
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'EquityPriceRiskEquityTrustPlansMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskEquityTrustPlansProductName',
    'EquityPriceRiskEquityTrustPlansPurchaseCost',
    'EquityPriceRiskEquityTrustPlansAdmittedValue',
    'EquityPriceRiskEquityTrustPlansRiskExposure',
    'EquityPriceRiskEquityTrustPlansBaseRiskFactor',
    'EquityPriceRiskEquityTrustPlansMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""""%%"""",OID , '%%') from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;
",,,,,,,,,,,,,,,,,,,
node:product,0,4,,,,,,,,,,,,,,,,,,
relation:hold-company-product,1,2,3,5,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,,,,,,,,,,,,,,,
EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessAbstract,EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessAbstract,EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractName,EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractualValue,EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessRiskFactor,EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessMinimumCapital,,,,,,,,,,,,,,,
MR19-权益价格风险，股指期货空头（不符合有效性） [abstract],MR19-权益价格风险，股指期货空头（不符合有效性） [abstract],股指期货空头合约名称,股指期货空头合约价值,风险因子RF,最低资本,,,,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractName' then T.VALUE_DATA else 0 end ) '股指期货空头合约名称',
Max(case T.ELE_NAME when 'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractualValue' then T.VALUE_DATA else 0 end ) '股指期货空头合约价值',
Max(case T.ELE_NAME when 'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessRiskFactor' then T.VALUE_DATA else 0 end ) '风险因子RF',
Max(case T.ELE_NAME when 'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessMinimumCapital' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractName',
    'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessContractualValue',
    'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessRiskFactor',
    'EquityPriceRiskShortPositionOfStockIndexFuturesOutOfEffectivenessMinimumCapital'
 )
  AND C.PERIOD_NAME= '期末'
) T

GROUP BY T.DIM_GID;",,,,,,,,,,,,,,,,,,,
node:stock,0,2,,,,,,,,,,,,,,,,,,
relation:buy-company-stock,1,3,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskPreferredSharesHeldByCompanyDirectlyAbstract,layer,EquityPriceRiskPreferredSharesName,EquityPriceRiskPreferredSharesHoldingStockNumber,EquityPriceRiskPreferredSharesPurchaseCost,EquityPriceRiskPreferredSharesAdmittedValue,EquityPriceRiskPreferredSharesRiskExposure,EquityPriceRiskPreferredSharesBaseRiskFactor,EquityPriceRiskPreferredSharesMinimumCapital,,,,,,,,,,,,
MR20-权益价格风险，公司直接持有的优先股 [abstract],layer,优先股名称,持股数量（股）,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
layer,HeldByCompanyDirectlyMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member],,,,,,,,,,,,,,,,,,,
layer,PreferredSharesIssuedByListedCompanyMember-PreferredSharesPubliclyIssuedByListedCompanyMember-PreferredSharesNonPubliclyIssuedByListedCompanyMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithoutTermsOnObligatoryConversionToCommonStockOrIssuedByListedNonBankingOrNonInsuranceCompanyMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCompanyMember-PreferredSharesIssuedByNonListedPublicBankOrInsuranceCompanyWithoutTermsOnObligatoryConversionToCommonStockOrIssuedByNonListedPublicNonBankingOrNonInsuranceCompanyMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicPolicyBankStateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicJointStockCommercialBankPostSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByOtherNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember,,,,,,,,,,,,,,,,,,,
layer_zh,上市公司 [member]-上市公司-公开发行 [member]-上市公司-非公开发行 [member]-银行、保险公司发行的不带强制转换为普通股条款的或者非银行、非保险机构发行的 [member]-银行、保险公司发行的带有强制转换为普通股条款的 [member]-各级资本充足率全部达到监管要求 [member]-各级资本充足率未全部达到监管要求 [member]-非上市公众公司 [member]-银行、保险公司发行的不带强制转换为普通股条款的或者非银行、非保险机构发行的 [member]-商业银行发行带有强制转换为普通股条款的 [member]-各级资本充足率全部达到监管要求 [member]-政策性银行、国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行 [member]-其他商业银行 [member]-各级资本充足率未全部达到监管要求 [member]-保险公司发行带有强制转换为普通股条款的 [member]-各级偿付能力充足率全部达到监管要求 [member]-各级偿付能力充足率未全部达到监管要求 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesName' THEN T.VALUE_DATA ELSE 0 END ) '优先股名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesHoldingStockNumber' THEN T.VALUE_DATA ELSE 0 END ) '持股数量（股）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('EquityPriceRiskPreferredSharesName',
    'EquityPriceRiskPreferredSharesHoldingStockNumber',
    'EquityPriceRiskPreferredSharesPurchaseCost',
    'EquityPriceRiskPreferredSharesAdmittedValue',
    'EquityPriceRiskPreferredSharesRiskExposure',
    'EquityPriceRiskPreferredSharesBaseRiskFactor',
    'EquityPriceRiskPreferredSharesMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:stock,0,5,,,,,,,,,,,,,,,,,,
relation:buy-company-stock,1,2,3,4,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,,,,,,,,,,,,
EquityPriceRiskPreferredSharesHeldByLookThroughMethodAbstract,layer,EquityPriceRiskPreferredSharesName,EquityPriceRiskPreferredSharesHoldingStockNumber,EquityPriceRiskPreferredSharesPurchaseCost,EquityPriceRiskPreferredSharesAdmittedValue,EquityPriceRiskPreferredSharesRiskExposure,EquityPriceRiskPreferredSharesBaseRiskFactor,EquityPriceRiskPreferredSharesMinimumCapital,,,,,,,,,,,,
MR21-权益价格风险，穿透法还原后持有的优先股 [abstract],layer,优先股名称,持股数量（股）,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,
layer,HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,PreferredSharesIssuedByListedCompanyMember-PreferredSharesPubliclyIssuedByListedCompanyMember-PreferredSharesNonPubliclyIssuedByListedCompanyMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithoutTermsOnObligatoryConversionToCommonStockOrIssuedByListedNonBankingOrNonInsuranceCompanyMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesNonPubliclyIssuedByListedBankOrInsuranceCompanyWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCompanyMember-PreferredSharesIssuedByNonListedPublicBankOrInsuranceCompanyWithoutTermsOnObligatoryConversionToCommonStockOrIssuedByNonListedPublicNonBankingOrNonInsuranceCompanyMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicPolicyBankStateOwnedCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicJointStockCommercialBankPostSavingsBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCityCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByOtherNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicCommercialBankWithCapitalAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember-PreferredSharesIssuedByNonListedPublicInsuranceCompanyWithSolvencyAdequacyRatiosAtAllTiersNotEntirelyMeetingRegulatoryRequirementsWithTermsOnObligatoryConversionToCommonStockMember,,,,,,,,,,,,,,,,,,,
layer_zh,上市公司 [member]-上市公司-公开发行 [member]-上市公司-非公开发行 [member]-银行、保险公司发行的不带强制转换为普通股条款的或者非银行、非保险机构发行的 [member]-银行、保险公司发行的带有强制转换为普通股条款的 [member]-各级资本充足率全部达到监管要求 [member]-各级资本充足率未全部达到监管要求 [member]-非上市公众公司 [member]-银行、保险公司发行的不带强制转换为普通股条款的或者非银行、非保险机构发行的 [member]-商业银行发行带有强制转换为普通股条款的 [member]-各级资本充足率全部达到监管要求 [member]-政策性银行、国有商业银行 [member]-股份制商业银行、邮政储蓄银行 [member]-城市商业银行 [member]-其他商业银行 [member]-各级资本充足率未全部达到监管要求 [member]-保险公司发行带有强制转换为普通股条款的 [member]-各级偿付能力充足率全部达到监管要求 [member]-各级偿付能力充足率未全部达到监管要求 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesName' THEN T.VALUE_DATA ELSE 0 END ) '优先股名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesHoldingStockNumber' THEN T.VALUE_DATA ELSE 0 END ) '持股数量（股）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskPreferredSharesMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('EquityPriceRiskPreferredSharesName',
    'EquityPriceRiskPreferredSharesHoldingStockNumber',
    'EquityPriceRiskPreferredSharesPurchaseCost',
    'EquityPriceRiskPreferredSharesAdmittedValue',
    'EquityPriceRiskPreferredSharesRiskExposure',
    'EquityPriceRiskPreferredSharesBaseRiskFactor',
    'EquityPriceRiskPreferredSharesMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:stock,0,5,,,,,,,,,,,,,,,,,,
relation:buy-company-stock,1,2,3,4,6,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesAbstract,layer,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesCompanyName,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesHoldingStockNumber,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesProportionOfOwnershipInterests,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesEquityHoldingCost,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesNatureOfInvestee,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesAdmittedValue,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskExposure,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesBaseRiskFactor,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskFactorOne,EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesMinimumCapital,,,,,,,,,
MR22-权益价格风险，对子公司、合营企业和联营企业的长期股权投资 [abstract],layer,企业名称,持股数量（股）,持股比例,持股成本,投资对象性质,认可价值,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,,,,
layer,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member]-穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,LongTermEquityInvestmentsInSubsidiariesMember-LongTermEquityInvestmentsInJointVenturesAndAssociatedCompaniesMember,,,,,,,,,,,,,,,,,,,
layer_zh,对子公司的长期股权投资 [member]-对合营企业和联营企业的长期股权投资 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesCompanyName' THEN T.VALUE_DATA ELSE 0 END ) '企业名称',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesHoldingStockNumber' THEN T.VALUE_DATA ELSE 0 END ) '持股数量（股）',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesProportionOfOwnershipInterests' THEN T.VALUE_DATA ELSE 0 END ) '持股比例',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesEquityHoldingCost' THEN T.VALUE_DATA ELSE 0 END ) '持股成本',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesNatureOfInvestee' THEN T.VALUE_DATA ELSE 0 END ) '投资对象性质',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesCompanyName',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesHoldingStockNumber',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesProportionOfOwnershipInterests',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesEquityHoldingCost',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesNatureOfInvestee',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesAdmittedValue',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskExposure',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesBaseRiskFactor',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesRiskFactorOne',
   'EquityPriceRiskLongTermEquityInvestmentsInSubsidiariesJointVenturesAndAssociatedCompaniesMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
 %s
) T
GROUP BY T.DIM_GID","  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:equity,0,4,7,8,,,,,,,,,,,,,,,,
relation:hold-company-equity,1,2,3,5,6,9,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
PropertyPriceRiskInvestmentPropertyHeldByCompanyDirectlyAbstract,layer,PropertyPriceRiskInvestmentPropertyAssetDetails,PropertyPriceRiskInvestmentPropertyPurchaseCost,PropertyPriceRiskInvestmentPropertyLocation,PropertyPriceRiskInvestmentPropertyAdmittedValue,PropertyPriceRiskInvestmentPropertyRiskExposure,PropertyPriceRiskInvestmentPropertyBaseRiskFactor,PropertyPriceRiskInvestmentPropertyRiskFactorOne,PropertyPriceRiskInvestmentPropertyRiskFactorTwo,PropertyPriceRiskInvestmentPropertyRiskFactorThree,MarketRiskMinimumCapitalForPropertyPriceRisk,,,,,,,,,
MR23-房地产价格风险，公司直接持有的投资性房地产 [abstract],layer,资产明细,购买成本,所处位置,认可价值,风险暴露,基础因子RF0,特征系数K1,特征系数K2,特征系数K3,最低资本,,,,,,,,,
layer,InvestmentPropertyHeldAsRealPropertyMember-InvestmentPropertyHeldThroughProjectCompanyMember,,,,,,,,,,,,,,,,,,,
layer_zh,投资性不动产物权 [member]-不动产项目公司股权 [member],,,,,,,,,,,,,,,,,,,
layer,CostMethodMember-FairValueMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,成本法核算 [member]-公允价值核算 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyAssetDetails' THEN T.VALUE_DATA ELSE 0 END ) '资产明细',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyLocation' THEN T.VALUE_DATA ELSE 0 END ) '所处位置',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorTwo' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorThree' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K3',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForPropertyPriceRisk' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'PropertyPriceRiskInvestmentPropertyAssetDetails','PropertyPriceRiskInvestmentPropertyPurchaseCost',
         'PropertyPriceRiskInvestmentPropertyLocation','PropertyPriceRiskInvestmentPropertyAdmittedValue','PropertyPriceRiskInvestmentPropertyRiskExposure',
         'PropertyPriceRiskInvestmentPropertyBaseRiskFactor','PropertyPriceRiskInvestmentPropertyRiskFactorOne','PropertyPriceRiskInvestmentPropertyRiskFactorTwo',
          'PropertyPriceRiskInvestmentPropertyRiskFactorThree','MarketRiskMinimumCapitalForPropertyPriceRisk') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T
GROUP BY T.DIM_GID","  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = 'HeldByCompanyDirectlyMember')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:real_estate,0,1,2,5,8,,,,,,,,,,,,,,,
relation: hold-company-real_estate,3,4,6,7,9,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,,,,,,,,,
PropertyPriceRiskInvestmentPropertyHeldByLookThroughMethodAbstract,layer,PropertyPriceRiskInvestmentPropertyAssetDetails,PropertyPriceRiskInvestmentPropertyPurchaseCost,PropertyPriceRiskInvestmentPropertyLocation,PropertyPriceRiskInvestmentPropertyAdmittedValue,PropertyPriceRiskInvestmentPropertyRiskExposure,PropertyPriceRiskInvestmentPropertyBaseRiskFactor,PropertyPriceRiskInvestmentPropertyRiskFactorOne,PropertyPriceRiskInvestmentPropertyRiskFactorTwo,PropertyPriceRiskInvestmentPropertyRiskFactorThree,MarketRiskMinimumCapitalForPropertyPriceRisk,,,,,,,,,
MR24-房地产价格风险，穿透法还原后持有的投资性房地产 [abstract],layer,资产明细,购买成本,所处位置,认可价值,风险暴露,基础因子RF0,特征系数K1,特征系数K2,特征系数K3,最低资本,,,,,,,,,
layer,InvestmentPropertyHeldAsRealPropertyMember-InvestmentPropertyHeldThroughProjectCompanyMember,,,,,,,,,,,,,,,,,,,
layer_zh,投资性不动产物权 [member]-不动产项目公司股权 [member],,,,,,,,,,,,,,,,,,,
layer,CostMethodMember-FairValueMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,成本法核算 [member]-公允价值核算 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyAssetDetails' THEN T.VALUE_DATA ELSE 0 END ) '资产明细',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyLocation' THEN T.VALUE_DATA ELSE 0 END ) '所处位置',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorTwo' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'PropertyPriceRiskInvestmentPropertyRiskFactorThree' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K3',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForPropertyPriceRisk' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
  AND A.DWZD_BH = '%s' -- 单位
  AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'PropertyPriceRiskInvestmentPropertyAssetDetails','PropertyPriceRiskInvestmentPropertyPurchaseCost',
         'PropertyPriceRiskInvestmentPropertyLocation','PropertyPriceRiskInvestmentPropertyAdmittedValue','PropertyPriceRiskInvestmentPropertyRiskExposure',
         'PropertyPriceRiskInvestmentPropertyBaseRiskFactor','PropertyPriceRiskInvestmentPropertyRiskFactorOne','PropertyPriceRiskInvestmentPropertyRiskFactorTwo',
          'PropertyPriceRiskInvestmentPropertyRiskFactorThree','MarketRiskMinimumCapitalForPropertyPriceRisk') --   元素名称
  AND C.PERIOD_NAME= '期末'
%s
) T

GROUP BY T.DIM_GID","
  AND  DIM_GID IN (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = 'HeldByLookThroughMethodMember')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:real_estate,0,1,2,5,8,,,,,,,,,,,,,,,
relation:hold-company-real_estate,3,4,6,7,9,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,,,,,,,,,,,,,
PriceRiskOfOverseasFixedIncomeInvestmentAssetsDetailsAbstract,layer,OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAssetName,OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsPurchaseCost,OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAdmittedValue,OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsRiskExposure,OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsBaseRiskFactor,MarketRiskMinimumCapitalForOverseasFixedIncomeInvestmentAssetsPriceRisk,,,,,,,,,,,,,
MR25-境外固定收益类资产价格风险所涉资产明细表 [abstract],layer,资产名称,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,,,
layer,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member]-穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,DevelopedMarketsMember-EmergingMarketsMember,,,,,,,,,,,,,,,,,,,
layer_zh,发达市场 [member]-新兴市场 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAssetName' THEN T.VALUE_DATA ELSE 0 END ) '资产名称',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForOverseasFixedIncomeInvestmentAssetsPriceRisk' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAssetName',
    'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsPurchaseCost',
    'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsAdmittedValue',
    'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsRiskExposure',
    'OverseasAssetPriceRiskOverseasFixedIncomeInvestmentAssetsBaseRiskFactor',
    'MarketRiskMinimumCapitalForOverseasFixedIncomeInvestmentAssetsPriceRisk') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:overseas,0,4,,,,,,,,,,,,,,,,,,
relation:buy-company-overseas,1,2,3,5,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,,,,,,,,,,,
PriceRiskOfOverseasEquityInvestmentAssetsDetailsAbstract,layer,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetName,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetsCode,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsHoldingNumber,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsPurchaseCost,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAdmittedValue,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsRiskExposure,OverseasAssetPriceRiskOverseasEquityInvestmentAssetsBaseRiskFactor,MarketRiskMinimumCapitalForOverseasEquityInvestmentAssetsPriceRisk,,,,,,,,,,,
MR26-境外权益类资产价格风险所涉资产明细表 [abstract],layer,资产名称,资产代码,持仓数量,购买成本,认可价值,风险暴露,基础因子RF0,最低资本,,,,,,,,,,,
layer,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member]-穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,DevelopedMarketsMember-EmergingMarketsMember,,,,,,,,,,,,,,,,,,,
layer_zh,发达市场 [member]-新兴市场 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetName' THEN T.VALUE_DATA ELSE 0 END ) '资产名称',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetsCode' THEN T.VALUE_DATA ELSE 0 END ) '资产代码',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsHoldingNumber' THEN T.VALUE_DATA ELSE 0 END ) '持仓数量',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsPurchaseCost' THEN T.VALUE_DATA ELSE 0 END ) '购买成本',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAdmittedValue' THEN T.VALUE_DATA ELSE 0 END ) '认可价值',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'MarketRiskMinimumCapitalForOverseasEquityInvestmentAssetsPriceRisk' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetName',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAssetsCode',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsHoldingNumber',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsPurchaseCost',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsAdmittedValue',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsRiskExposure',
    'OverseasAssetPriceRiskOverseasEquityInvestmentAssetsBaseRiskFactor',
    'MarketRiskMinimumCapitalForOverseasEquityInvestmentAssetsPriceRisk') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
  
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:overseas,0,1,6,,,,,,,,,,,,,,,,,
relation:buy-company-overseas,2,3,4,5,7,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,,,,,,
ExchangeRateRiskOfProjectsForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedDetailsAbstract,layer,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProjects,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedDerivatives,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProperties,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedOtherForeignCurrencyDenominatedAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiabilities,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedNetAbsoluteValue,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskExposure,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedBaseRiskFactor,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskFactorOne,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedMinimumCapital,,,,,,
MR27-汇率风险所涉项目明细表，未套保及套保无效的外汇资产（负债） [abstract],layer,外币项目,外币流动性管理工具,外币固定收益类资产,外币权益类资产,外汇衍生品,外币房地产,外币其他资产,外币负债,净额绝对值,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,,,
layer,HeldByCompanyDirectlyMember-HeldByLookThroughMethodMember,,,,,,,,,,,,,,,,,,,
layer_zh,公司直接持有 [member]-穿透法还原后持有 [member],,,,,,,,,,,,,,,,,,,
layer,ForeignCurrencyItemsDenominatedInUsdAndCurrenciesDirectlyLinkedToUsdMember-ForeignCurrencyItemsDenominatedInEurMember-ForeignCurrencyItemsDenominatedInGbpMember-ForeignCurrencyItemsDenominatedInOtherForeignCurrenciesMember,,,,,,,,,,,,,,,,,,,
layer_zh,以美元和汇率跟美元挂钩的货币计价的外币项目 [member]-以欧元计价的外币项目 [member]-以英镑计价的外币项目 [member]-以其他货币计价的外币项目 [member],,,,,,,,,,,,,,,,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProjects' THEN T.VALUE_DATA ELSE 0 END ) '外币项目',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments' THEN T.VALUE_DATA ELSE 0 END ) '外币流动性管理工具',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币固定收益类资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币权益类资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedDerivatives' THEN T.VALUE_DATA ELSE 0 END ) '外汇衍生品',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProperties' THEN T.VALUE_DATA ELSE 0 END ) '外币房地产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedOtherForeignCurrencyDenominatedAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币其他资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiabilities' THEN T.VALUE_DATA ELSE 0 END ) '外币负债',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedNetAbsoluteValue' THEN T.VALUE_DATA ELSE 0 END ) '净额绝对值',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedMinimumCapital' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProjects',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedDerivatives',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedProperties',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedOtherForeignCurrencyDenominatedAssets',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedForeignCurrencyDenominatedLiabilities',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedNetAbsoluteValue',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskExposure',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedBaseRiskFactor',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedRiskFactorOne',
   'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesUnhedgedOrIneffectivelyHedgedMinimumCapital') --   元素名称
  AND C.PERIOD_NAME= '期末'
  %s
) T
GROUP BY T.DIM_GID","AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like (SELECT concat('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s')
                     AND MEMBER_VALUE like (SELECT CONCAT('%%',OID,'%%') FROM psx_element WHERE ELE_NAME = '%s'))",,,,,,,,,,,,,,,,,,
node:forex,0,10,11,,,,,,,,,,,,,,,,,
relation:hold-company-forex,1,2,3,4,5,6,7,8,9,12,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,,,,
ExchangeRateRiskOfProjectsForeignCurrencyDenominatedAssetsLiabilitiesEffectivelyHedgedDetailsAbstract,ForeignCurrencyItemsDenominatedInUsdAndCurrenciesDirectlyLinkedToUsdMember-ForeignCurrencyItemsDenominatedInEurMember-ForeignCurrencyItemsDenominatedInGbpMember-ForeignCurrencyItemsDenominatedInOtherForeignCurrenciesMember,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignExchangeForwardContractName,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedDerivatives,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedProperties,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedOtherForeignCurrencyDenominatedAssets,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiabilities,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedTotalSizeOfHedgedForeignCurrencyDenominatedAssetsLiabilities,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedHedgingEffectivenessOfForeignExchangeForwardContracts,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskExposure,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedBaseRiskFactor,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskFactorOne,ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedMinimumCapitalOfHedgingPortfolio,,,,
MR28-汇率风险所涉项目明细表，有效套保外汇资产（负债） [abstract],以美元和汇率跟美元挂钩的货币计价的外币项目 [member]-以欧元计价的外币项目 [member]-以英镑计价的外币项目 [member]-以其他货币计价的外币项目 [member],合约名称,外币流动性管理工具,外币固定收益类资产,外币权益类资产,外汇衍生品,外币房地产,外币其他资产,外币负债,被套期外币资产/负债总规模,外汇远期合约名义本金价值,套期有效性,风险暴露,基础因子RF0,特征系数K1,最低资本,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignExchangeForwardContractName' THEN T.VALUE_DATA ELSE 0 END ) '合约名称',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments' THEN T.VALUE_DATA ELSE 0 END ) '外币流动性管理工具',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币固定收益类资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币权益类资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedDerivatives' THEN T.VALUE_DATA ELSE 0 END ) '外汇衍生品',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedProperties' THEN T.VALUE_DATA ELSE 0 END ) '外币房地产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedOtherForeignCurrencyDenominatedAssets' THEN T.VALUE_DATA ELSE 0 END ) '外币其他资产',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiabilities' THEN T.VALUE_DATA ELSE 0 END ) '外币负债',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedTotalSizeOfHedgedForeignCurrencyDenominatedAssetsLiabilities' THEN T.VALUE_DATA ELSE 0 END ) '被套期外币资产/负债总规模',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts' THEN T.VALUE_DATA ELSE 0 END ) '外汇远期合约名义本金价值',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedHedgingEffectivenessOfForeignExchangeForwardContracts' THEN T.VALUE_DATA ELSE 0 END ) '套期有效性',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskExposure' THEN T.VALUE_DATA ELSE 0 END ) '风险暴露',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedBaseRiskFactor' THEN T.VALUE_DATA ELSE 0 END ) '基础因子RF0',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskFactorOne' THEN T.VALUE_DATA ELSE 0 END ) '特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedMinimumCapitalOfHedgingPortfolio' THEN T.VALUE_DATA ELSE 0 END ) '最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
  AND A.DWZD_BH = '%s' -- 单位
  AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN('ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignExchangeForwardContractName',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiquidityManagementInstruments',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedFixedIncomeInvestmentAssets',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedEquityInvestmentAssets',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedDerivatives',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedProperties',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedOtherForeignCurrencyDenominatedAssets',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedForeignCurrencyDenominatedLiabilities',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedTotalSizeOfHedgedForeignCurrencyDenominatedAssetsLiabilities',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedHedgingEffectivenessOfForeignExchangeForwardContracts',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskExposure',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedBaseRiskFactor',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedRiskFactorOne',
    'ExchangeRateRiskForeignCurrencyDenominatedAssetsLiabilitiesHighlyEffectivelyHedgedMinimumCapitalOfHedgingPortfolio') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T
GROUP BY T.DIM_GID",,,,,,,,,,,,,,,,,,,
node:forex,0,12,13,,,,,,,,,,,,,,,,,
relation:hold-company-forex,1,2,3,4,5,6,7,8,9,10,11,14,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,,,,,,,,,,,,,,
ExchangeRateRiskOfProjectsForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedDetailsAbstract,ForeignCurrencyItemsDenominatedInUsdAndCurrenciesDirectlyLinkedToUsdMember-ForeignCurrencyItemsDenominatedInEurMember-ForeignCurrencyItemsDenominatedInGbpMember-ForeignCurrencyItemsDenominatedInOtherForeignCurrenciesMember,ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedForeignCurrencyDenominatedAssetsLiabilities,ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts,ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedBaseRiskFactor,ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedRiskFactorOne,ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedMinimumCapitalOfForeignExchangeForwardContracts,,,,,,,,,,,,,,
MR29-汇率风险所涉项目明细表，无效套保外汇远期资产（负债） [abstract],以美元和汇率跟美元挂钩的货币计价的外币项目 [member]-以欧元计价的外币项目 [member]-以英镑计价的外币项目 [member]-以其他货币计价的外币项目 [member],外币资产（负债）,外汇远期合约名义本金价值,基础因子RF0,特征系数K1,最低资本,,,,,,,,,,,,,,
sql,"select 
Max(case T.ELE_NAME when 'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedForeignCurrencyDenominatedAssetsLiabilities' then T.VALUE_DATA else 0 end ) '外币资产（负债）',
Max(case T.ELE_NAME when 'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts' then T.VALUE_DATA else 0 end ) '外汇远期合约名义本金价值',
Max(case T.ELE_NAME when 'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedBaseRiskFactor' then T.VALUE_DATA else 0 end ) '基础因子RF0',
Max(case T.ELE_NAME when 'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedRiskFactorOne' then T.VALUE_DATA else 0 end ) '特征系数K1',
Max(case T.ELE_NAME when 'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedMinimumCapitalOfForeignExchangeForwardContracts' then T.VALUE_DATA else 0 end ) '最低资本'
FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME  IN ('ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedForeignCurrencyDenominatedAssetsLiabilities',
   'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedNominalPrincipalValueOfForeignExchangeForwardContracts',
   'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedBaseRiskFactor',
   'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedRiskFactorOne',
   'ExchangeRateRiskForeignExchangeForwardAssetsLiabilitiesIneffectivelyHedgedMinimumCapitalOfForeignExchangeForwardContracts'
 )
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE like ( select concat(""%%"",OID , '%%') from psx_element where ELE_NAME ='%s' ))
) T

GROUP BY T.DIM_GID;
",,,,,,,,,,,,,,,,,,,
node:forex,0,2,3,,,,,,,,,,,,,,,,,
relation:hold-company-forex,1,4,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18
InsuranceRiskOfNonLifeInsuranceBusinessOfPropertyAndCasualtyInsuranceCompanyAndLifeInsuranceCompanyPremiumAndReserveRiskAbstract,NonLifeInsuranceBusinessAutoInsuranceMember-NonLifeInsuranceBusinessPropertyInsuranceMember-NonLifeInsuranceBusinessMarineAndHullCargoAndSpecialRiskInsuranceMember-NonLifeInsuranceBusinessLiabilityInsuranceMember-NonLifeInsuranceBusinessAgricultureInsuranceMember-NonLifeInsuranceBusinessCreditGuaranteeInsuranceMember-NonLifeInsuranceBusinessShortTermAccidentInsuranceMember-NonLifeInsuranceBusinessShortTermHealthInsuranceMember-NonLifeInsuranceBusinessShortTermLifeInsuranceMember-NonLifeInsuranceBusinessOtherInsuranceMember,NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths,NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths,NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths,RetainedPremiumsInMostRecentTwelveMonths,OutstandingLossReserveNetOfReinsurance,CombinedRatio,VariationOfCombinedRatio,ArithmeticalMeanOfRetrospectiveDeviationRatiosOfOutstandingLossReserve,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification,InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification,InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorThreeOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfReserveRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk
IR01-财险和人身险公司非寿险业务保险风险，保费和准备金风险 [abstract],车险 [member]-财产险 [member]-船货特险 [member]-责任险 [member]-农业险 [member]-信用保证险 [member]-短意险 [member]-短健险 [member]-短寿险 [member]-其他险 [member],过去12个月非比例分保分出保费,过去12个月非比例分保分入保费,过去12个月非比例分保净分出保费,过去12个月自留保费,再保后未决赔款准备金,综合成本率,综合成本率变动,未决赔款准备金回溯偏差率的算术平均数,风险分散前的最低资本,风险分散效应,风险分散后的最低资本,保费风险风险暴露,保费风险特征系数K1,保费风险特征系数K2,保费风险特征系数K3,保费风险最低资本,准备金风险风险暴露,准备金风险特征系数K1,准备金风险最低资本
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保分出保费',
MAX(CASE T.ELE_NAME WHEN 'NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保分入保费',
MAX(CASE T.ELE_NAME WHEN 'NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保净分出保费',
MAX(CASE T.ELE_NAME WHEN 'RetainedPremiumsInMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月自留保费',
MAX(CASE T.ELE_NAME WHEN 'OutstandingLossReserveNetOfReinsurance' THEN T.VALUE_DATA ELSE 0 END ) '再保后未决赔款准备金',
MAX(CASE T.ELE_NAME WHEN 'CombinedRatio' THEN T.VALUE_DATA ELSE 0 END ) '综合成本率',
MAX(CASE T.ELE_NAME WHEN 'VariationOfCombinedRatio' THEN T.VALUE_DATA ELSE 0 END ) '综合成本率变动',
MAX(CASE T.ELE_NAME WHEN 'ArithmeticalMeanOfRetrospectiveDeviationRatiosOfOutstandingLossReserve' THEN T.VALUE_DATA ELSE 0 END ) '未决赔款准备金回溯偏差率的算术平均数',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification' THEN T.VALUE_DATA ELSE 0 END ) '风险分散前的最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '风险分散效应',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification' THEN T.VALUE_DATA ELSE 0 END ) '风险分散后的最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorThreeOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险特征系数K3',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '准备金风险风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '准备金风险特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '准备金风险最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths','NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths',
         'NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths','RetainedPremiumsInMostRecentTwelveMonths',
         'OutstandingLossReserveNetOfReinsurance','CombinedRatio','VariationOfCombinedRatio',
         'ArithmeticalMeanOfRetrospectiveDeviationRatiosOfOutstandingLossReserve','InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk','InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk','InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk','InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorThreeOfPremiumRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk','InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfReserveRisk','InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk') --   元素名称
  AND C.PERIOD_NAME= '期末'
  AND  DIM_GID in (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T
",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,,,,,,,,,,,,,,,,,,
InsuranceRiskOfNonLifeInsuranceBusinessOfPropertyAndCasualtyInsuranceCompanyAndLifeInsuranceCompanyCatastropheRiskAbstract,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfAutoInsurance-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForTyphoonAndFloodCatastropheRiskOfPropertyInsurance-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForEarthquakeCatastropheRiskOfPropertyInsurance-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfAgricultureInsurance-InsuranceRiskOfNonLifeInsuranceBusinessDiversificationEffectOfCatastropheRisk-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRisk,end,,,,,,,,,,,,,,,,,,
IR02-财险和人身险公司非寿险业务保险风险，巨灾风险 [abstract],车险巨灾风险最低资本-财产险台风及洪水巨灾风险最低资本-财产险地震巨灾风险最低资本-农业险巨灾风险最低资本-巨灾风险分散效应-非寿险业务巨灾风险最低资本,期末,,,,,,,,,,,,,,,,,,
sql,"SELECT
  CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = ' '",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,,,,
InsuranceRiskOfNonLifeReinsuranceBusinessOfReinsuranceCompanyPremiumAndReserveRiskAbstract,NonLifeReinsuranceBusinessProportionalAutoReinsuranceMember-NonLifeReinsuranceBusinessProportionalPropertyReinsuranceMember-NonLifeReinsuranceBusinessProportionalMarineAndHullCargoAndSpecialRiskReinsuranceMember-NonLifeReinsuranceBusinessProportionalLiabilityReinsuranceMember-NonLifeReinsuranceBusinessProportionalAgricultureReinsuranceMember-NonLifeReinsuranceBusinessProportionalCreditGuaranteeReinsuranceMember-NonLifeReinsuranceBusinessProportionalShortTermAccidentReinsuranceMember-NonLifeReinsuranceBusinessProportionalShortTermHealthReinsuranceMember-NonLifeReinsuranceBusinessProportionalShortTermLifeReinsuranceMember-NonLifeReinsuranceBusinessOtherProportionalReinsuranceMember-NonLifeReinsuranceBusinessNonProportionalPropertyReinsuranceMember-NonLifeReinsuranceBusinessNonProportionalLiabilityReinsuranceAndShortTermAccidentHealthAndLifeReinsuranceMember-NonLifeReinsuranceBusinessNonProportionalSpecialReinsuranceMember,NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths,NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths,NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths,RetainedPremiumsInMostRecentTwelveMonths,OutstandingLossReserveNetOfReinsurance,CombinedRatio,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification,InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification,InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk,InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk,,,,
IR03-再保险公司非寿险再保险业务保险风险，保费和准备金风险 [abstract],比例车险 [member]-比例财产险 [member]-比例船货特险 [member]-比例责任险 [member]-比例农业险 [member]-比例信用保证险 [member]-比例短期意外险 [member]-比例短健险 [member]-比例短寿险 [member]-比例其他险 [member]-非比例财产险 [member]-非比例责任、短意、短健、短寿 [member]-非比例特殊风险 [member],过去12个月非比例分保分出保费,过去12个月非比例分保分入保费,过去12个月非比例分保净分出保费,过去12个月自留保费,再保后未决赔款准备金,综合成本率,风险分散前的最低资本,风险分散效应,风险分散后的最低资本,保费风险风险暴露,保费风险特征系数K1,保费风险特征系数K2,保费风险最低资本,准备金风险风险暴露,准备金风险最低资本,,,,
sql,"select 
MAX(CASE T.ELE_NAME WHEN 'NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保分出保费',
MAX(CASE T.ELE_NAME WHEN 'NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保分入保费',
MAX(CASE T.ELE_NAME WHEN 'NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月非比例分保净分出保费',
MAX(CASE T.ELE_NAME WHEN 'RetainedPremiumsInMostRecentTwelveMonths' THEN T.VALUE_DATA ELSE 0 END ) '过去12个月自留保费',
MAX(CASE T.ELE_NAME WHEN 'OutstandingLossReserveNetOfReinsurance' THEN T.VALUE_DATA ELSE 0 END ) '再保后未决赔款准备金',
MAX(CASE T.ELE_NAME WHEN 'CombinedRatio' THEN T.VALUE_DATA ELSE 0 END ) '综合成本率',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification' THEN T.VALUE_DATA ELSE 0 END ) '风险分散前的最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '风险分散效应',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification' THEN T.VALUE_DATA ELSE 0 END ) '风险分散后的最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险特征系数K1',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险特征系数K2',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk' THEN T.VALUE_DATA ELSE 0 END ) '保费风险最低资本',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '准备金风险风险暴露',
MAX(CASE T.ELE_NAME WHEN 'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk' THEN T.VALUE_DATA ELSE 0 END ) '准备金风险最低资本'

FROM
(
SELECT
  ELE_NAME,CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA,DIM_GID
 FROM
  psx_dw_instdata A,
  psx_element B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    psx_context_period X
   LEFT JOIN psx_context Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = C.OID
  AND A.DWZD_BH = '%s' -- 单位
  AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME IN( 'NonProportionalReinsurancePremiumPaidOfMostRecentTwelveMonths','NonProportionalReinsurancePremiumReceivedOfMostRecentTwelveMonths',
         'NetCedingPremiumsOfNonProportionalReinsuranceOfMostRecentTwelveMonths','RetainedPremiumsInMostRecentTwelveMonths',
         'OutstandingLossReserveNetOfReinsurance','CombinedRatio',
         'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskBeforeRiskDiversification',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskDiversificationEffectOfPremiumAndReserveRisk','InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForPremiumAndReserveRiskAfterRiskDiversification',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfPremiumRisk','InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorOneOfPremiumRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessRiskFactorTwoOfPremiumRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfPremiumRisk','InsuranceRiskOfNonLifeInsuranceBusinessRiskExposureOfReserveRisk',
         'InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalOfReserveRisk') --   元素名称
   AND C.PERIOD_NAME= '本季'
  AND  DIM_GID = (SELECT OID FROM psx_dimension_group WHERE MEMBER_VALUE = (SELECT OID FROM psx_element WHERE ELE_NAME = '%s'))
) T",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,,,,,,,,,,,,,,,,,,
InsuranceRiskOfNonLifeReinsuranceBusinessOfReinsuranceCompanyCatastropheRiskAbstract,InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfAutoInsuranceOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForTyphoonAndFloodCatastropheRiskOfPropertyInsuranceOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForEarthquakeCatastropheRiskOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfAgricultureInsuranceOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessDiversificationEffectOfCatastropheRiskOfProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRiskOfNonProportionalReinsuranceBusiness-InsuranceRiskOfNonLifeInsuranceBusinessDiversificationEffectOfCatastropheRisk-InsuranceRiskOfNonLifeInsuranceBusinessMinimumCapitalForCatastropheRisk,end,,,,,,,,,,,,,,,,,,
IR04-再保险公司非寿险再保险业务保险风险，巨灾风险 [abstract],比例再保险业务巨灾风险最低资本-比例业务-车险巨灾风险最低资本-比例业务-财产险台风及洪水巨灾风险最低资本-比例业务-财产险地震巨灾风险最低资本-比例业务-农业险巨灾风险最低资本-比例再保险业务巨灾风险分散效应-非比例再保险业务巨灾风险最低资本-非寿险再保险业务巨灾风险分散效应-非寿险再保险业务巨灾风险最低资本,期末,,,,,,,,,,,,,,,,,,
sql,"SELECT
  CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = ' '",,,,,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
AbstractTable,Tables,0,,,,,,,,,,,,,,,,,,
InsuranceRiskOfLifeInsuranceBusinessAbstract,InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskMortalityRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskDeathCatastropheRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskLongevityRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskMorbidityRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskMedicalAndHealthLossIncidenceRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskOtherIncidenceRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForIncidenceRiskRiskDiversificationEffect-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForSurrenderRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForSurrenderRiskSurrenderRateRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForSurrenderRiskMassLapseRisk-InsuranceRiskOfLifeInsuranceBusinessMinimumCapitalForExpenseRisk-InsuranceRiskOfLifeInsuranceBusinessRiskDiversificationEffect-MinimumCapitalForInsuranceRiskOfLifeInsuranceBusiness,end,,,,,,,,,,,,,,,,,,
IR05-寿险业务保险风险 [abstract],寿险业务保险风险-损失发生风险最低资本-损失发生风险最低资本-死亡发生率风险-损失发生风险最低资本-死亡巨灾风险-损失发生风险最低资本-长寿风险-损失发生风险最低资本-疾病发生率风险-损失发生风险最低资本-医疗及健康赔付损失率风险-损失发生风险最低资本-其它损失发生率风险-损失发生风险最低资本-风险分散效应-寿险业务保险风险-退保风险最低资本-退保风险最低资本-退保率风险-退保风险最低资本-大规模退保风险-寿险业务保险风险-费用风险最低资本-寿险业务保险风险-风险分散效应-寿险业务保险风险最低资本合计,期末,,,,,,,,,,,,,,,,,,
sql,"SELECT
  CASE WHEN VALUE_TYPE = 0 THEN NUM_VALUE ELSE CHAR_VALUE END AS VALUE_DATA
 FROM
  PSX_DW_INSTDATA A,
  PSX_ELEMENT B,
  (
   SELECT
    X.PERIOD_NAME,
    X.PERIOD_ID,
    Y.OID
   FROM
    PSX_CONTEXT_PERIOD X
   LEFT JOIN PSX_CONTEXT Y ON(
    X.PERIOD_ID = Y.CON_APPPERIOD
   )
  ) C
 WHERE
  A.ELE_ID = B.OID
 AND A.CON_ID = c.OID
 AND A.DWZD_BH = '%s' -- 单位
 AND A.INST_DATE = '%s' -- 日期
 AND ELE_NAME = '%s' --   元素名称
  AND C.PERIOD_NAME = '期末' 
  AND  DIM_GID = ' '",,,,・,,,,,,,,,,,,,,,
end,,,,,,,,,,,,,,,,,,,,
